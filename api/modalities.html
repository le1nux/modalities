

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>modalities package &mdash; Modalities 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=2709fde1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="modalities.checkpointing package" href="modalities.checkpointing.html" />
    <link rel="prev" title="modalities" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Modalities
              <img src="../_static/logo.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_cards.html">Model Cards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarking.html">Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../known_issues.html">Known Issues</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Datasets</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../memmap.html">MemMap Datasets</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Entrypoints</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints.html">Entrypoints</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">VSCode Setup</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vs_code_setup.html">VSCode Setup</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Future Work</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../future_work.html">Future Work</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">modalities</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">modalities package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html">modalities.checkpointing package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html">modalities.config package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.html">modalities.conversion package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html">modalities.dataloader package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.html">modalities.inference package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html">modalities.logging_broker package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html">modalities.models package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html">modalities.nn package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html">modalities.optimizers package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html">modalities.preprocessing package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.registry.html">modalities.registry package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html">modalities.running_env package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html">modalities.tokenization package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html">modalities.training package</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html">modalities.utils package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.api">modalities.api module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.FileExistencePolicy"><code class="docutils literal notranslate"><span class="pre">FileExistencePolicy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.convert_pytorch_to_hf_checkpoint"><code class="docutils literal notranslate"><span class="pre">convert_pytorch_to_hf_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.create_filtered_tokenized_dataset"><code class="docutils literal notranslate"><span class="pre">create_filtered_tokenized_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.create_raw_data_index"><code class="docutils literal notranslate"><span class="pre">create_raw_data_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.create_shuffled_dataset_chunk"><code class="docutils literal notranslate"><span class="pre">create_shuffled_dataset_chunk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.create_shuffled_jsonl_dataset_chunk"><code class="docutils literal notranslate"><span class="pre">create_shuffled_jsonl_dataset_chunk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.enforce_file_existence_policy"><code class="docutils literal notranslate"><span class="pre">enforce_file_existence_policy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.generate_text"><code class="docutils literal notranslate"><span class="pre">generate_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.merge_packed_data_files"><code class="docutils literal notranslate"><span class="pre">merge_packed_data_files()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.pack_encoded_data"><code class="docutils literal notranslate"><span class="pre">pack_encoded_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.shuffle_jsonl_data"><code class="docutils literal notranslate"><span class="pre">shuffle_jsonl_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.api.shuffle_tokenized_data"><code class="docutils literal notranslate"><span class="pre">shuffle_tokenized_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.batch">modalities.batch module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.Batch"><code class="docutils literal notranslate"><span class="pre">Batch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.DatasetBatch"><code class="docutils literal notranslate"><span class="pre">DatasetBatch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.EvaluationResultBatch"><code class="docutils literal notranslate"><span class="pre">EvaluationResultBatch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.InferenceResultBatch"><code class="docutils literal notranslate"><span class="pre">InferenceResultBatch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.ResultItem"><code class="docutils literal notranslate"><span class="pre">ResultItem</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.batch.TorchDeviceMixin"><code class="docutils literal notranslate"><span class="pre">TorchDeviceMixin</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.evaluator">modalities.evaluator module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.evaluator.Evaluator"><code class="docutils literal notranslate"><span class="pre">Evaluator</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.exceptions">modalities.exceptions module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.BatchStateError"><code class="docutils literal notranslate"><span class="pre">BatchStateError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.CheckpointingError"><code class="docutils literal notranslate"><span class="pre">CheckpointingError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.ConfigError"><code class="docutils literal notranslate"><span class="pre">ConfigError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.DatasetNotFoundError"><code class="docutils literal notranslate"><span class="pre">DatasetNotFoundError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.OptimizerError"><code class="docutils literal notranslate"><span class="pre">OptimizerError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.RunningEnvError"><code class="docutils literal notranslate"><span class="pre">RunningEnvError</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.exceptions.TimeRecorderStateError"><code class="docutils literal notranslate"><span class="pre">TimeRecorderStateError</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.gym">modalities.gym module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.gym.Gym"><code class="docutils literal notranslate"><span class="pre">Gym</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.loss_functions">modalities.loss_functions module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.loss_functions.CLMCrossEntropyLoss"><code class="docutils literal notranslate"><span class="pre">CLMCrossEntropyLoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.loss_functions.Loss"><code class="docutils literal notranslate"><span class="pre">Loss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.loss_functions.NCELoss"><code class="docutils literal notranslate"><span class="pre">NCELoss</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.loss_functions.nce_loss"><code class="docutils literal notranslate"><span class="pre">nce_loss()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.trainer">modalities.trainer module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.trainer.ThroughputAggregationKeys"><code class="docutils literal notranslate"><span class="pre">ThroughputAggregationKeys</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.trainer.Trainer"><code class="docutils literal notranslate"><span class="pre">Trainer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities.util">modalities.util module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.Aggregator"><code class="docutils literal notranslate"><span class="pre">Aggregator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.TimeRecorder"><code class="docutils literal notranslate"><span class="pre">TimeRecorder</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.TimeRecorderStates"><code class="docutils literal notranslate"><span class="pre">TimeRecorderStates</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.format_metrics_to_gb"><code class="docutils literal notranslate"><span class="pre">format_metrics_to_gb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_callback_interval_in_batches_per_rank"><code class="docutils literal notranslate"><span class="pre">get_callback_interval_in_batches_per_rank()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_experiment_id_of_run"><code class="docutils literal notranslate"><span class="pre">get_experiment_id_of_run()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_local_number_of_trainable_parameters"><code class="docutils literal notranslate"><span class="pre">get_local_number_of_trainable_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_module_class_from_name"><code class="docutils literal notranslate"><span class="pre">get_module_class_from_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.get_total_number_of_trainable_parameters"><code class="docutils literal notranslate"><span class="pre">get_total_number_of_trainable_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.parse_enum_by_name"><code class="docutils literal notranslate"><span class="pre">parse_enum_by_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.print_rank_0"><code class="docutils literal notranslate"><span class="pre">print_rank_0()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#modalities.util.warn_rank_0"><code class="docutils literal notranslate"><span class="pre">warn_rank_0()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-modalities">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Modalities</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">modalities</a></li>
      <li class="breadcrumb-item active">modalities package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/modalities.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="modalities-package">
<h1>modalities package<a class="headerlink" href="#modalities-package" title="Link to this heading"></a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="modalities.checkpointing.html">modalities.checkpointing package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.fsdp.html">modalities.checkpointing.fsdp package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.fsdp.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.fsdp.html#module-modalities.checkpointing.fsdp.fsdp_checkpoint_loading">modalities.checkpointing.fsdp.fsdp_checkpoint_loading module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.fsdp.html#module-modalities.checkpointing.fsdp.fsdp_checkpoint_saving">modalities.checkpointing.fsdp.fsdp_checkpoint_saving module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.fsdp.html#module-modalities.checkpointing.fsdp">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.torch.html">modalities.checkpointing.torch package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.torch.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.torch.html#module-modalities.checkpointing.torch.torch_checkpoint_loading">modalities.checkpointing.torch.torch_checkpoint_loading module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.torch.html#module-modalities.checkpointing.torch.torch_checkpoint_saving">modalities.checkpointing.torch.torch_checkpoint_saving module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.torch.html#module-modalities.checkpointing.torch">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_conversion">modalities.checkpointing.checkpoint_conversion module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_conversion.CheckpointConversion"><code class="docutils literal notranslate"><span class="pre">CheckpointConversion</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_conversion.CheckpointConversion.convert_pytorch_to_hf_checkpoint"><code class="docutils literal notranslate"><span class="pre">CheckpointConversion.convert_pytorch_to_hf_checkpoint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_loading">modalities.checkpointing.checkpoint_loading module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_loading.CheckpointLoadingIF"><code class="docutils literal notranslate"><span class="pre">CheckpointLoadingIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_loading.CheckpointLoadingIF.load_model_checkpoint"><code class="docutils literal notranslate"><span class="pre">CheckpointLoadingIF.load_model_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_loading.CheckpointLoadingIF.load_optimizer_checkpoint"><code class="docutils literal notranslate"><span class="pre">CheckpointLoadingIF.load_optimizer_checkpoint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_saving">modalities.checkpointing.checkpoint_saving module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving.CheckpointEntityType"><code class="docutils literal notranslate"><span class="pre">CheckpointEntityType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving.CheckpointEntityType.MODEL"><code class="docutils literal notranslate"><span class="pre">CheckpointEntityType.MODEL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving.CheckpointEntityType.OPTIMIZER"><code class="docutils literal notranslate"><span class="pre">CheckpointEntityType.OPTIMIZER</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving.CheckpointSaving"><code class="docutils literal notranslate"><span class="pre">CheckpointSaving</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving.CheckpointSaving.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">CheckpointSaving.save_checkpoint()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_saving_execution">modalities.checkpointing.checkpoint_saving_execution module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_execution.CheckpointSavingExecutionABC"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingExecutionABC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_execution.CheckpointSavingExecutionABC.run_checkpoint_instruction"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingExecutionABC.run_checkpoint_instruction()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_saving_instruction">modalities.checkpointing.checkpoint_saving_instruction module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_instruction.CheckpointingInstruction"><code class="docutils literal notranslate"><span class="pre">CheckpointingInstruction</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_instruction.CheckpointingInstruction.checkpoints_to_delete"><code class="docutils literal notranslate"><span class="pre">CheckpointingInstruction.checkpoints_to_delete</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_instruction.CheckpointingInstruction.save_current"><code class="docutils literal notranslate"><span class="pre">CheckpointingInstruction.save_current</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing.checkpoint_saving_strategies">modalities.checkpointing.checkpoint_saving_strategies module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.CheckpointSavingStrategyIF"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingStrategyIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.CheckpointSavingStrategyIF.get_checkpoint_instruction"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingStrategyIF.get_checkpoint_instruction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.SaveEveryKStepsCheckpointingStrategy"><code class="docutils literal notranslate"><span class="pre">SaveEveryKStepsCheckpointingStrategy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.SaveEveryKStepsCheckpointingStrategy.get_checkpoint_instruction"><code class="docutils literal notranslate"><span class="pre">SaveEveryKStepsCheckpointingStrategy.get_checkpoint_instruction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.SaveKMostRecentCheckpointsStrategy"><code class="docutils literal notranslate"><span class="pre">SaveKMostRecentCheckpointsStrategy</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving_strategies.SaveKMostRecentCheckpointsStrategy.get_checkpoint_instruction"><code class="docutils literal notranslate"><span class="pre">SaveKMostRecentCheckpointsStrategy.get_checkpoint_instruction()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.checkpointing.html#module-modalities.checkpointing">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.config.html">modalities.config package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#module-modalities.config.component_factory">modalities.config.component_factory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.component_factory.ComponentFactory"><code class="docutils literal notranslate"><span class="pre">ComponentFactory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.component_factory.ComponentFactory.build_components"><code class="docutils literal notranslate"><span class="pre">ComponentFactory.build_components()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#module-modalities.config.config">modalities.config.config module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.ActivationCheckpointedModelConfig"><code class="docutils literal notranslate"><span class="pre">ActivationCheckpointedModelConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ActivationCheckpointedModelConfig.activation_checkpointing_modules"><code class="docutils literal notranslate"><span class="pre">ActivationCheckpointedModelConfig.activation_checkpointing_modules</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ActivationCheckpointedModelConfig.model"><code class="docutils literal notranslate"><span class="pre">ActivationCheckpointedModelConfig.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ActivationCheckpointedModelConfig.model_config"><code class="docutils literal notranslate"><span class="pre">ActivationCheckpointedModelConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamOptimizerConfig"><code class="docutils literal notranslate"><span class="pre">AdamOptimizerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamOptimizerConfig.betas"><code class="docutils literal notranslate"><span class="pre">AdamOptimizerConfig.betas</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamOptimizerConfig.eps"><code class="docutils literal notranslate"><span class="pre">AdamOptimizerConfig.eps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamOptimizerConfig.lr"><code class="docutils literal notranslate"><span class="pre">AdamOptimizerConfig.lr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamOptimizerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">AdamOptimizerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamOptimizerConfig.weight_decay"><code class="docutils literal notranslate"><span class="pre">AdamOptimizerConfig.weight_decay</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamOptimizerConfig.weight_decay_groups_excluded"><code class="docutils literal notranslate"><span class="pre">AdamOptimizerConfig.weight_decay_groups_excluded</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamOptimizerConfig.wrapped_model"><code class="docutils literal notranslate"><span class="pre">AdamOptimizerConfig.wrapped_model</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamWOptimizerConfig"><code class="docutils literal notranslate"><span class="pre">AdamWOptimizerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamWOptimizerConfig.betas"><code class="docutils literal notranslate"><span class="pre">AdamWOptimizerConfig.betas</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamWOptimizerConfig.eps"><code class="docutils literal notranslate"><span class="pre">AdamWOptimizerConfig.eps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamWOptimizerConfig.lr"><code class="docutils literal notranslate"><span class="pre">AdamWOptimizerConfig.lr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamWOptimizerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">AdamWOptimizerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamWOptimizerConfig.weight_decay"><code class="docutils literal notranslate"><span class="pre">AdamWOptimizerConfig.weight_decay</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamWOptimizerConfig.weight_decay_groups_excluded"><code class="docutils literal notranslate"><span class="pre">AdamWOptimizerConfig.weight_decay_groups_excluded</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.AdamWOptimizerConfig.wrapped_model"><code class="docutils literal notranslate"><span class="pre">AdamWOptimizerConfig.wrapped_model</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.BatchSamplerConfig"><code class="docutils literal notranslate"><span class="pre">BatchSamplerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.BatchSamplerConfig.batch_size"><code class="docutils literal notranslate"><span class="pre">BatchSamplerConfig.batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.BatchSamplerConfig.drop_last"><code class="docutils literal notranslate"><span class="pre">BatchSamplerConfig.drop_last</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.BatchSamplerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">BatchSamplerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.BatchSamplerConfig.sampler"><code class="docutils literal notranslate"><span class="pre">BatchSamplerConfig.sampler</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.CLMCrossEntropyLossConfig"><code class="docutils literal notranslate"><span class="pre">CLMCrossEntropyLossConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CLMCrossEntropyLossConfig.model_config"><code class="docutils literal notranslate"><span class="pre">CLMCrossEntropyLossConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CLMCrossEntropyLossConfig.prediction_key"><code class="docutils literal notranslate"><span class="pre">CLMCrossEntropyLossConfig.prediction_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CLMCrossEntropyLossConfig.target_key"><code class="docutils literal notranslate"><span class="pre">CLMCrossEntropyLossConfig.target_key</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointSavingConfig"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointSavingConfig.checkpoint_saving_execution"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingConfig.checkpoint_saving_execution</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointSavingConfig.checkpoint_saving_strategy"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingConfig.checkpoint_saving_strategy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointSavingConfig.model_config"><code class="docutils literal notranslate"><span class="pre">CheckpointSavingConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedModelConfig"><code class="docutils literal notranslate"><span class="pre">CheckpointedModelConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedModelConfig.checkpoint_loading"><code class="docutils literal notranslate"><span class="pre">CheckpointedModelConfig.checkpoint_loading</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedModelConfig.checkpoint_path"><code class="docutils literal notranslate"><span class="pre">CheckpointedModelConfig.checkpoint_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedModelConfig.model"><code class="docutils literal notranslate"><span class="pre">CheckpointedModelConfig.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedModelConfig.model_config"><code class="docutils literal notranslate"><span class="pre">CheckpointedModelConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedOptimizerConfig"><code class="docutils literal notranslate"><span class="pre">CheckpointedOptimizerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedOptimizerConfig.checkpoint_loading"><code class="docutils literal notranslate"><span class="pre">CheckpointedOptimizerConfig.checkpoint_loading</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedOptimizerConfig.checkpoint_path"><code class="docutils literal notranslate"><span class="pre">CheckpointedOptimizerConfig.checkpoint_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedOptimizerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">CheckpointedOptimizerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedOptimizerConfig.optimizer"><code class="docutils literal notranslate"><span class="pre">CheckpointedOptimizerConfig.optimizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CheckpointedOptimizerConfig.wrapped_model"><code class="docutils literal notranslate"><span class="pre">CheckpointedOptimizerConfig.wrapped_model</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.CombinedDatasetConfig"><code class="docutils literal notranslate"><span class="pre">CombinedDatasetConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CombinedDatasetConfig.datasets"><code class="docutils literal notranslate"><span class="pre">CombinedDatasetConfig.datasets</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CombinedDatasetConfig.model_config"><code class="docutils literal notranslate"><span class="pre">CombinedDatasetConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.ConstantLRSchedulerConfig"><code class="docutils literal notranslate"><span class="pre">ConstantLRSchedulerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ConstantLRSchedulerConfig.factor"><code class="docutils literal notranslate"><span class="pre">ConstantLRSchedulerConfig.factor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ConstantLRSchedulerConfig.last_epoch"><code class="docutils literal notranslate"><span class="pre">ConstantLRSchedulerConfig.last_epoch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ConstantLRSchedulerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">ConstantLRSchedulerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ConstantLRSchedulerConfig.optimizer"><code class="docutils literal notranslate"><span class="pre">ConstantLRSchedulerConfig.optimizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ConstantLRSchedulerConfig.total_iters"><code class="docutils literal notranslate"><span class="pre">ConstantLRSchedulerConfig.total_iters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ConstantLRSchedulerConfig.verbose"><code class="docutils literal notranslate"><span class="pre">ConstantLRSchedulerConfig.verbose</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.CosineAnnealingLRSchedulerConfig"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingLRSchedulerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CosineAnnealingLRSchedulerConfig.eta_min"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingLRSchedulerConfig.eta_min</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CosineAnnealingLRSchedulerConfig.last_epoch"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingLRSchedulerConfig.last_epoch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CosineAnnealingLRSchedulerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingLRSchedulerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CosineAnnealingLRSchedulerConfig.optimizer"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingLRSchedulerConfig.optimizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CosineAnnealingLRSchedulerConfig.t_max"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingLRSchedulerConfig.t_max</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.CosineAnnealingLRSchedulerConfig.verbose"><code class="docutils literal notranslate"><span class="pre">CosineAnnealingLRSchedulerConfig.verbose</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.DistributedSamplerConfig"><code class="docutils literal notranslate"><span class="pre">DistributedSamplerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DistributedSamplerConfig.dataset"><code class="docutils literal notranslate"><span class="pre">DistributedSamplerConfig.dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DistributedSamplerConfig.drop_last"><code class="docutils literal notranslate"><span class="pre">DistributedSamplerConfig.drop_last</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DistributedSamplerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">DistributedSamplerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DistributedSamplerConfig.num_replicas"><code class="docutils literal notranslate"><span class="pre">DistributedSamplerConfig.num_replicas</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DistributedSamplerConfig.rank"><code class="docutils literal notranslate"><span class="pre">DistributedSamplerConfig.rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DistributedSamplerConfig.seed"><code class="docutils literal notranslate"><span class="pre">DistributedSamplerConfig.seed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DistributedSamplerConfig.shuffle"><code class="docutils literal notranslate"><span class="pre">DistributedSamplerConfig.shuffle</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.DummyLRSchedulerConfig"><code class="docutils literal notranslate"><span class="pre">DummyLRSchedulerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DummyLRSchedulerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">DummyLRSchedulerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DummyLRSchedulerConfig.optimizer"><code class="docutils literal notranslate"><span class="pre">DummyLRSchedulerConfig.optimizer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.DummyProgressSubscriberConfig"><code class="docutils literal notranslate"><span class="pre">DummyProgressSubscriberConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DummyProgressSubscriberConfig.model_config"><code class="docutils literal notranslate"><span class="pre">DummyProgressSubscriberConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.DummyResultSubscriberConfig"><code class="docutils literal notranslate"><span class="pre">DummyResultSubscriberConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.DummyResultSubscriberConfig.model_config"><code class="docutils literal notranslate"><span class="pre">DummyResultSubscriberConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointLoadingConfig"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointLoadingConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointLoadingConfig.block_names"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointLoadingConfig.block_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointLoadingConfig.global_rank"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointLoadingConfig.global_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointLoadingConfig.mixed_precision_settings"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointLoadingConfig.mixed_precision_settings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointLoadingConfig.model_config"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointLoadingConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointLoadingConfig.parse_mixed_precision_setting_by_name"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointLoadingConfig.parse_mixed_precision_setting_by_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointLoadingConfig.parse_sharding_strategy_by_name"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointLoadingConfig.parse_sharding_strategy_by_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointLoadingConfig.sharding_strategy"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointLoadingConfig.sharding_strategy</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointSavingConfig"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointSavingConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointSavingConfig.checkpoint_path"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointSavingConfig.checkpoint_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointSavingConfig.experiment_id"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointSavingConfig.experiment_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointSavingConfig.global_rank"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointSavingConfig.global_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPCheckpointSavingConfig.model_config"><code class="docutils literal notranslate"><span class="pre">FSDPCheckpointSavingConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPWrappedModelConfig"><code class="docutils literal notranslate"><span class="pre">FSDPWrappedModelConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPWrappedModelConfig.block_names"><code class="docutils literal notranslate"><span class="pre">FSDPWrappedModelConfig.block_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPWrappedModelConfig.mixed_precision_settings"><code class="docutils literal notranslate"><span class="pre">FSDPWrappedModelConfig.mixed_precision_settings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPWrappedModelConfig.model"><code class="docutils literal notranslate"><span class="pre">FSDPWrappedModelConfig.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPWrappedModelConfig.model_config"><code class="docutils literal notranslate"><span class="pre">FSDPWrappedModelConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPWrappedModelConfig.parse_mixed_precision_setting_by_name"><code class="docutils literal notranslate"><span class="pre">FSDPWrappedModelConfig.parse_mixed_precision_setting_by_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPWrappedModelConfig.parse_sharding_strategy_by_name"><code class="docutils literal notranslate"><span class="pre">FSDPWrappedModelConfig.parse_sharding_strategy_by_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPWrappedModelConfig.sharding_strategy"><code class="docutils literal notranslate"><span class="pre">FSDPWrappedModelConfig.sharding_strategy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.FSDPWrappedModelConfig.sync_module_states"><code class="docutils literal notranslate"><span class="pre">FSDPWrappedModelConfig.sync_module_states</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.GPT2LLMCollateFnConfig"><code class="docutils literal notranslate"><span class="pre">GPT2LLMCollateFnConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.GPT2LLMCollateFnConfig.model_config"><code class="docutils literal notranslate"><span class="pre">GPT2LLMCollateFnConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.GPT2LLMCollateFnConfig.sample_key"><code class="docutils literal notranslate"><span class="pre">GPT2LLMCollateFnConfig.sample_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.GPT2LLMCollateFnConfig.target_key"><code class="docutils literal notranslate"><span class="pre">GPT2LLMCollateFnConfig.target_key</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.LLMDataLoaderConfig"><code class="docutils literal notranslate"><span class="pre">LLMDataLoaderConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LLMDataLoaderConfig.batch_sampler"><code class="docutils literal notranslate"><span class="pre">LLMDataLoaderConfig.batch_sampler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LLMDataLoaderConfig.collate_fn"><code class="docutils literal notranslate"><span class="pre">LLMDataLoaderConfig.collate_fn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LLMDataLoaderConfig.dataloader_tag"><code class="docutils literal notranslate"><span class="pre">LLMDataLoaderConfig.dataloader_tag</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LLMDataLoaderConfig.dataset"><code class="docutils literal notranslate"><span class="pre">LLMDataLoaderConfig.dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LLMDataLoaderConfig.model_config"><code class="docutils literal notranslate"><span class="pre">LLMDataLoaderConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LLMDataLoaderConfig.num_workers"><code class="docutils literal notranslate"><span class="pre">LLMDataLoaderConfig.num_workers</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LLMDataLoaderConfig.pin_memory"><code class="docutils literal notranslate"><span class="pre">LLMDataLoaderConfig.pin_memory</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.LinearLRSchedulerConfig"><code class="docutils literal notranslate"><span class="pre">LinearLRSchedulerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LinearLRSchedulerConfig.end_factor"><code class="docutils literal notranslate"><span class="pre">LinearLRSchedulerConfig.end_factor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LinearLRSchedulerConfig.last_epoch"><code class="docutils literal notranslate"><span class="pre">LinearLRSchedulerConfig.last_epoch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LinearLRSchedulerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">LinearLRSchedulerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LinearLRSchedulerConfig.optimizer"><code class="docutils literal notranslate"><span class="pre">LinearLRSchedulerConfig.optimizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LinearLRSchedulerConfig.start_factor"><code class="docutils literal notranslate"><span class="pre">LinearLRSchedulerConfig.start_factor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LinearLRSchedulerConfig.total_iters"><code class="docutils literal notranslate"><span class="pre">LinearLRSchedulerConfig.total_iters</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.LinearLRSchedulerConfig.verbose"><code class="docutils literal notranslate"><span class="pre">LinearLRSchedulerConfig.verbose</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.MemMapDatasetConfig"><code class="docutils literal notranslate"><span class="pre">MemMapDatasetConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.MemMapDatasetConfig.index_path"><code class="docutils literal notranslate"><span class="pre">MemMapDatasetConfig.index_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.MemMapDatasetConfig.jq_pattern"><code class="docutils literal notranslate"><span class="pre">MemMapDatasetConfig.jq_pattern</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.MemMapDatasetConfig.model_config"><code class="docutils literal notranslate"><span class="pre">MemMapDatasetConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.MemMapDatasetConfig.raw_data_path"><code class="docutils literal notranslate"><span class="pre">MemMapDatasetConfig.raw_data_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.MemMapDatasetConfig.sample_key"><code class="docutils literal notranslate"><span class="pre">MemMapDatasetConfig.sample_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.MemMapDatasetConfig.tokenizer"><code class="docutils literal notranslate"><span class="pre">MemMapDatasetConfig.tokenizer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.anneal_strategy"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.anneal_strategy</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.base_momentum"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.base_momentum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.check_totals_steps_and_epchs"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.check_totals_steps_and_epchs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.cycle_momentum"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.cycle_momentum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.div_factor"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.div_factor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.epochs"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.epochs</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.final_div_factor"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.final_div_factor</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.last_epoch"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.last_epoch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.max_lr"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.max_lr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.max_momentum"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.max_momentum</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.optimizer"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.optimizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.pct_start"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.pct_start</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.steps_per_epoch"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.steps_per_epoch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.three_phase"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.three_phase</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.total_steps"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.total_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.OneCycleLRSchedulerConfig.verbose"><code class="docutils literal notranslate"><span class="pre">OneCycleLRSchedulerConfig.verbose</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.PackedMemMapDatasetContinuousConfig"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetContinuousConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PackedMemMapDatasetContinuousConfig.model_config"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetContinuousConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PackedMemMapDatasetContinuousConfig.raw_data_path"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetContinuousConfig.raw_data_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PackedMemMapDatasetContinuousConfig.sample_key"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetContinuousConfig.sample_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PackedMemMapDatasetContinuousConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetContinuousConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.PackedMemMapDatasetMegatronConfig"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetMegatronConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PackedMemMapDatasetMegatronConfig.block_size"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetMegatronConfig.block_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PackedMemMapDatasetMegatronConfig.model_config"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetMegatronConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PackedMemMapDatasetMegatronConfig.raw_data_path"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetMegatronConfig.raw_data_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PackedMemMapDatasetMegatronConfig.sample_key"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetMegatronConfig.sample_key</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.PassType"><code class="docutils literal notranslate"><span class="pre">PassType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PassType.BY_REFERENCE"><code class="docutils literal notranslate"><span class="pre">PassType.BY_REFERENCE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PassType.BY_VALUE"><code class="docutils literal notranslate"><span class="pre">PassType.BY_VALUE</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.PreTrainedHFTokenizerConfig"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PreTrainedHFTokenizerConfig.max_length"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizerConfig.max_length</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PreTrainedHFTokenizerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PreTrainedHFTokenizerConfig.padding"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizerConfig.padding</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PreTrainedHFTokenizerConfig.pretrained_model_name_or_path"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizerConfig.pretrained_model_name_or_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PreTrainedHFTokenizerConfig.special_tokens"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizerConfig.special_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PreTrainedHFTokenizerConfig.truncation"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizerConfig.truncation</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.PreTrainedSPTokenizerConfig"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PreTrainedSPTokenizerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PreTrainedSPTokenizerConfig.tokenizer_model_file"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizerConfig.tokenizer_model_file</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.PrecisionEnum"><code class="docutils literal notranslate"><span class="pre">PrecisionEnum</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PrecisionEnum.BF16"><code class="docutils literal notranslate"><span class="pre">PrecisionEnum.BF16</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PrecisionEnum.FP16"><code class="docutils literal notranslate"><span class="pre">PrecisionEnum.FP16</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.PrecisionEnum.FP32"><code class="docutils literal notranslate"><span class="pre">PrecisionEnum.FP32</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.ProcessGroupBackendType"><code class="docutils literal notranslate"><span class="pre">ProcessGroupBackendType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ProcessGroupBackendType.nccl"><code class="docutils literal notranslate"><span class="pre">ProcessGroupBackendType.nccl</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.ReferenceConfig"><code class="docutils literal notranslate"><span class="pre">ReferenceConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ReferenceConfig.instance_key"><code class="docutils literal notranslate"><span class="pre">ReferenceConfig.instance_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ReferenceConfig.model_config"><code class="docutils literal notranslate"><span class="pre">ReferenceConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ReferenceConfig.pass_type"><code class="docutils literal notranslate"><span class="pre">ReferenceConfig.pass_type</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.ResumableDistributedSamplerConfig"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSamplerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ResumableDistributedSamplerConfig.dataset"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSamplerConfig.dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ResumableDistributedSamplerConfig.drop_last"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSamplerConfig.drop_last</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ResumableDistributedSamplerConfig.epoch"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSamplerConfig.epoch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ResumableDistributedSamplerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSamplerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ResumableDistributedSamplerConfig.num_replicas"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSamplerConfig.num_replicas</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ResumableDistributedSamplerConfig.rank"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSamplerConfig.rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ResumableDistributedSamplerConfig.seed"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSamplerConfig.seed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ResumableDistributedSamplerConfig.shuffle"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSamplerConfig.shuffle</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.ResumableDistributedSamplerConfig.skip_num_global_samples"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSamplerConfig.skip_num_global_samples</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichProgressSubscriberConfig"><code class="docutils literal notranslate"><span class="pre">RichProgressSubscriberConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichProgressSubscriberConfig.eval_dataloaders"><code class="docutils literal notranslate"><span class="pre">RichProgressSubscriberConfig.eval_dataloaders</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichProgressSubscriberConfig.global_rank"><code class="docutils literal notranslate"><span class="pre">RichProgressSubscriberConfig.global_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichProgressSubscriberConfig.model_config"><code class="docutils literal notranslate"><span class="pre">RichProgressSubscriberConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichProgressSubscriberConfig.num_seen_steps"><code class="docutils literal notranslate"><span class="pre">RichProgressSubscriberConfig.num_seen_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichProgressSubscriberConfig.num_target_steps"><code class="docutils literal notranslate"><span class="pre">RichProgressSubscriberConfig.num_target_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichProgressSubscriberConfig.train_dataloader_tag"><code class="docutils literal notranslate"><span class="pre">RichProgressSubscriberConfig.train_dataloader_tag</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichResultSubscriberConfig"><code class="docutils literal notranslate"><span class="pre">RichResultSubscriberConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichResultSubscriberConfig.global_rank"><code class="docutils literal notranslate"><span class="pre">RichResultSubscriberConfig.global_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichResultSubscriberConfig.model_config"><code class="docutils literal notranslate"><span class="pre">RichResultSubscriberConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.RichResultSubscriberConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">RichResultSubscriberConfig.num_ranks</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.SaveEveryKStepsCheckpointingStrategyConfig"><code class="docutils literal notranslate"><span class="pre">SaveEveryKStepsCheckpointingStrategyConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.SaveEveryKStepsCheckpointingStrategyConfig.k"><code class="docutils literal notranslate"><span class="pre">SaveEveryKStepsCheckpointingStrategyConfig.k</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.SaveEveryKStepsCheckpointingStrategyConfig.model_config"><code class="docutils literal notranslate"><span class="pre">SaveEveryKStepsCheckpointingStrategyConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.SaveKMostRecentCheckpointsStrategyConfig"><code class="docutils literal notranslate"><span class="pre">SaveKMostRecentCheckpointsStrategyConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.SaveKMostRecentCheckpointsStrategyConfig.k"><code class="docutils literal notranslate"><span class="pre">SaveKMostRecentCheckpointsStrategyConfig.k</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.SaveKMostRecentCheckpointsStrategyConfig.model_config"><code class="docutils literal notranslate"><span class="pre">SaveKMostRecentCheckpointsStrategyConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.SequentialSamplerConfig"><code class="docutils literal notranslate"><span class="pre">SequentialSamplerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.SequentialSamplerConfig.data_source"><code class="docutils literal notranslate"><span class="pre">SequentialSamplerConfig.data_source</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.SequentialSamplerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">SequentialSamplerConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.StepLRSchedulerConfig"><code class="docutils literal notranslate"><span class="pre">StepLRSchedulerConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.StepLRSchedulerConfig.gamma"><code class="docutils literal notranslate"><span class="pre">StepLRSchedulerConfig.gamma</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.StepLRSchedulerConfig.last_epoch"><code class="docutils literal notranslate"><span class="pre">StepLRSchedulerConfig.last_epoch</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.StepLRSchedulerConfig.model_config"><code class="docutils literal notranslate"><span class="pre">StepLRSchedulerConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.StepLRSchedulerConfig.optimizer"><code class="docutils literal notranslate"><span class="pre">StepLRSchedulerConfig.optimizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.StepLRSchedulerConfig.step_size"><code class="docutils literal notranslate"><span class="pre">StepLRSchedulerConfig.step_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.StepLRSchedulerConfig.verbose"><code class="docutils literal notranslate"><span class="pre">StepLRSchedulerConfig.verbose</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.TokenizerTypes"><code class="docutils literal notranslate"><span class="pre">TokenizerTypes</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.TokenizerTypes.GPT2TokenizerFast"><code class="docutils literal notranslate"><span class="pre">TokenizerTypes.GPT2TokenizerFast</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.TokenizerTypes.LlamaTokenizerFast"><code class="docutils literal notranslate"><span class="pre">TokenizerTypes.LlamaTokenizerFast</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.TorchCheckpointLoadingConfig"><code class="docutils literal notranslate"><span class="pre">TorchCheckpointLoadingConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.TorchCheckpointLoadingConfig.device"><code class="docutils literal notranslate"><span class="pre">TorchCheckpointLoadingConfig.device</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.TorchCheckpointLoadingConfig.model_config"><code class="docutils literal notranslate"><span class="pre">TorchCheckpointLoadingConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.TorchCheckpointLoadingConfig.parse_device"><code class="docutils literal notranslate"><span class="pre">TorchCheckpointLoadingConfig.parse_device()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.TorchCheckpointLoadingConfig.precision"><code class="docutils literal notranslate"><span class="pre">TorchCheckpointLoadingConfig.precision</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandBEvaluationResultSubscriberConfig"><code class="docutils literal notranslate"><span class="pre">WandBEvaluationResultSubscriberConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandBEvaluationResultSubscriberConfig.config_file_path"><code class="docutils literal notranslate"><span class="pre">WandBEvaluationResultSubscriberConfig.config_file_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandBEvaluationResultSubscriberConfig.directory"><code class="docutils literal notranslate"><span class="pre">WandBEvaluationResultSubscriberConfig.directory</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandBEvaluationResultSubscriberConfig.experiment_id"><code class="docutils literal notranslate"><span class="pre">WandBEvaluationResultSubscriberConfig.experiment_id</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandBEvaluationResultSubscriberConfig.global_rank"><code class="docutils literal notranslate"><span class="pre">WandBEvaluationResultSubscriberConfig.global_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandBEvaluationResultSubscriberConfig.mode"><code class="docutils literal notranslate"><span class="pre">WandBEvaluationResultSubscriberConfig.mode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandBEvaluationResultSubscriberConfig.model_config"><code class="docutils literal notranslate"><span class="pre">WandBEvaluationResultSubscriberConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandBEvaluationResultSubscriberConfig.project"><code class="docutils literal notranslate"><span class="pre">WandBEvaluationResultSubscriberConfig.project</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandbMode"><code class="docutils literal notranslate"><span class="pre">WandbMode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandbMode.DISABLED"><code class="docutils literal notranslate"><span class="pre">WandbMode.DISABLED</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandbMode.OFFLINE"><code class="docutils literal notranslate"><span class="pre">WandbMode.OFFLINE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WandbMode.ONLINE"><code class="docutils literal notranslate"><span class="pre">WandbMode.ONLINE</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.WeightInitializedModelConfig"><code class="docutils literal notranslate"><span class="pre">WeightInitializedModelConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WeightInitializedModelConfig.model"><code class="docutils literal notranslate"><span class="pre">WeightInitializedModelConfig.model</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WeightInitializedModelConfig.model_config"><code class="docutils literal notranslate"><span class="pre">WeightInitializedModelConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.config.WeightInitializedModelConfig.model_initializer"><code class="docutils literal notranslate"><span class="pre">WeightInitializedModelConfig.model_initializer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.config.load_app_config_dict"><code class="docutils literal notranslate"><span class="pre">load_app_config_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#module-modalities.config.instantiation_models">modalities.config.instantiation_models module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.ConsistencyEnforcement"><code class="docutils literal notranslate"><span class="pre">ConsistencyEnforcement</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.ConsistencyEnforcement.enforce_last_step_checkpointed"><code class="docutils literal notranslate"><span class="pre">ConsistencyEnforcement.enforce_last_step_checkpointed</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.ConsistencyEnforcement.enforce_last_step_evaluated"><code class="docutils literal notranslate"><span class="pre">ConsistencyEnforcement.enforce_last_step_evaluated</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.ConsistencyEnforcement.enforce_last_step_logged"><code class="docutils literal notranslate"><span class="pre">ConsistencyEnforcement.enforce_last_step_logged</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.ConsistencyEnforcement.enforce_tokens_per_step_consistency"><code class="docutils literal notranslate"><span class="pre">ConsistencyEnforcement.enforce_tokens_per_step_consistency</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.ConsistencyEnforcement.model_config"><code class="docutils literal notranslate"><span class="pre">ConsistencyEnforcement.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.CudaEnvSettings"><code class="docutils literal notranslate"><span class="pre">CudaEnvSettings</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.CudaEnvSettings.global_rank"><code class="docutils literal notranslate"><span class="pre">CudaEnvSettings.global_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.CudaEnvSettings.local_rank"><code class="docutils literal notranslate"><span class="pre">CudaEnvSettings.local_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.CudaEnvSettings.model_config"><code class="docutils literal notranslate"><span class="pre">CudaEnvSettings.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.CudaEnvSettings.world_size"><code class="docutils literal notranslate"><span class="pre">CudaEnvSettings.world_size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.Intervals"><code class="docutils literal notranslate"><span class="pre">Intervals</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.Intervals.checkpointing_interval_in_steps"><code class="docutils literal notranslate"><span class="pre">Intervals.checkpointing_interval_in_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.Intervals.evaluation_interval_in_steps"><code class="docutils literal notranslate"><span class="pre">Intervals.evaluation_interval_in_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.Intervals.model_config"><code class="docutils literal notranslate"><span class="pre">Intervals.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.Intervals.training_log_interval_in_steps"><code class="docutils literal notranslate"><span class="pre">Intervals.training_log_interval_in_steps</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.PackedDatasetComponentsInstantiationModel"><code class="docutils literal notranslate"><span class="pre">PackedDatasetComponentsInstantiationModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.PackedDatasetComponentsInstantiationModel.PackedDatasetSettings"><code class="docutils literal notranslate"><span class="pre">PackedDatasetComponentsInstantiationModel.PackedDatasetSettings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.PackedDatasetComponentsInstantiationModel.model_config"><code class="docutils literal notranslate"><span class="pre">PackedDatasetComponentsInstantiationModel.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.PackedDatasetComponentsInstantiationModel.settings"><code class="docutils literal notranslate"><span class="pre">PackedDatasetComponentsInstantiationModel.settings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.PackedDatasetComponentsInstantiationModel.tokenizer"><code class="docutils literal notranslate"><span class="pre">PackedDatasetComponentsInstantiationModel.tokenizer</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.StepProfile"><code class="docutils literal notranslate"><span class="pre">StepProfile</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.StepProfile.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">StepProfile.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.StepProfile.local_train_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">StepProfile.local_train_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.StepProfile.model_config"><code class="docutils literal notranslate"><span class="pre">StepProfile.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.StepProfile.sequence_length"><code class="docutils literal notranslate"><span class="pre">StepProfile.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TextGenerationInstantiationModel"><code class="docutils literal notranslate"><span class="pre">TextGenerationInstantiationModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TextGenerationInstantiationModel.TextGenerationSettings"><code class="docutils literal notranslate"><span class="pre">TextGenerationInstantiationModel.TextGenerationSettings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TextGenerationInstantiationModel.model_config"><code class="docutils literal notranslate"><span class="pre">TextGenerationInstantiationModel.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TextGenerationInstantiationModel.settings"><code class="docutils literal notranslate"><span class="pre">TextGenerationInstantiationModel.settings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TextGenerationInstantiationModel.text_inference_component"><code class="docutils literal notranslate"><span class="pre">TextGenerationInstantiationModel.text_inference_component</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.Settings"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.Settings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.checkpoint_saving"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.checkpoint_saving</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.eval_dataloaders"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.eval_dataloaders</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.evaluation_subscriber"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.evaluation_subscriber</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.gradient_clipper"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.gradient_clipper</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.loss_fn"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.loss_fn</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.model_config"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.optimizer"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.optimizer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.progress_subscriber"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.progress_subscriber</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.scheduler"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.scheduler</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.settings"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.settings</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.train_dataloader"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.train_dataloader</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.train_dataset"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.train_dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingComponentsInstantiationModel.wrapped_model"><code class="docutils literal notranslate"><span class="pre">TrainingComponentsInstantiationModel.wrapped_model</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingProgress"><code class="docutils literal notranslate"><span class="pre">TrainingProgress</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingProgress.global_num_seen_tokens"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.global_num_seen_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingProgress.last_step"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.last_step</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingProgress.model_config"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingProgress.num_seen_samples"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingProgress.num_seen_steps"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_steps</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingReportGenerator"><code class="docutils literal notranslate"><span class="pre">TrainingReportGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingReportGenerator.get_report"><code class="docutils literal notranslate"><span class="pre">TrainingReportGenerator.get_report()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingTarget"><code class="docutils literal notranslate"><span class="pre">TrainingTarget</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingTarget.model_config"><code class="docutils literal notranslate"><span class="pre">TrainingTarget.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingTarget.num_target_steps"><code class="docutils literal notranslate"><span class="pre">TrainingTarget.num_target_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.config.html#modalities.config.instantiation_models.TrainingTarget.num_target_tokens"><code class="docutils literal notranslate"><span class="pre">TrainingTarget.num_target_tokens</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#module-modalities.config.lookup_enum">modalities.config.lookup_enum module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.lookup_enum.LookupEnum"><code class="docutils literal notranslate"><span class="pre">LookupEnum</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#module-modalities.config.pydanctic_if_types">modalities.config.pydanctic_if_types module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.pydanctic_if_types.PydanticThirdPartyTypeIF"><code class="docutils literal notranslate"><span class="pre">PydanticThirdPartyTypeIF</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#module-modalities.config.utils">modalities.config.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.utils.convert_base_model_config_to_dict"><code class="docutils literal notranslate"><span class="pre">convert_base_model_config_to_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.config.html#modalities.config.utils.parse_torch_device"><code class="docutils literal notranslate"><span class="pre">parse_torch_device()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.config.html#module-modalities.config">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.conversion.html">modalities.conversion package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.conversion.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.conversion.gpt2.html">modalities.conversion.gpt2 package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2.configuration_gpt2">modalities.conversion.gpt2.configuration_gpt2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2.conversion_code">modalities.conversion.gpt2.conversion_code module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2.conversion_model">modalities.conversion.gpt2.conversion_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2.conversion_tokenizer">modalities.conversion.gpt2.conversion_tokenizer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2.convert_gpt2">modalities.conversion.gpt2.convert_gpt2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2.modeling_gpt2">modalities.conversion.gpt2.modeling_gpt2 module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.conversion.gpt2.html#module-modalities.conversion.gpt2">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.conversion.html#module-modalities.conversion">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.dataloader.html">modalities.dataloader package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.preprocessing.html">modalities.dataloader.preprocessing package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.preprocessing.html#module-modalities.dataloader.preprocessing">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.create_index">modalities.dataloader.create_index module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_index.IndexGenerator"><code class="docutils literal notranslate"><span class="pre">IndexGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_index.IndexGenerator.create_index"><code class="docutils literal notranslate"><span class="pre">IndexGenerator.create_index()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.create_packed_data">modalities.dataloader.create_packed_data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData.DATA_SECTION_LENGTH_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData.DATA_SECTION_LENGTH_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData.HEADER_SIZE_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData.HEADER_SIZE_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData.TOKEN_SIZE_DESCRIPTOR_LENGTH_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData.TOKEN_SIZE_DESCRIPTOR_LENGTH_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData.data"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData.data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmbeddedStreamData.index_base"><code class="docutils literal notranslate"><span class="pre">EmbeddedStreamData.index_base</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.EmptySampleError"><code class="docutils literal notranslate"><span class="pre">EmptySampleError</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.PackedDataGenerator"><code class="docutils literal notranslate"><span class="pre">PackedDataGenerator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.PackedDataGenerator.run"><code class="docutils literal notranslate"><span class="pre">PackedDataGenerator.run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.create_packed_data.join_embedded_stream_data"><code class="docutils literal notranslate"><span class="pre">join_embedded_stream_data()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.dataloader">modalities.dataloader.dataloader module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader.LLMDataLoader"><code class="docutils literal notranslate"><span class="pre">LLMDataLoader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader.LLMDataLoader.dataloader_tag"><code class="docutils literal notranslate"><span class="pre">LLMDataLoader.dataloader_tag</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.dataloader_factory">modalities.dataloader.dataloader_factory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader_factory.DataloaderFactory"><code class="docutils literal notranslate"><span class="pre">DataloaderFactory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader_factory.DataloaderFactory.get_dataloader"><code class="docutils literal notranslate"><span class="pre">DataloaderFactory.get_dataloader()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.dataset">modalities.dataloader.dataset module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.CombinedDataset"><code class="docutils literal notranslate"><span class="pre">CombinedDataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.Dataset"><code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummyDataset"><code class="docutils literal notranslate"><span class="pre">DummyDataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummyDatasetConfig"><code class="docutils literal notranslate"><span class="pre">DummyDatasetConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummyDatasetConfig.model_config"><code class="docutils literal notranslate"><span class="pre">DummyDatasetConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummyDatasetConfig.num_samples"><code class="docutils literal notranslate"><span class="pre">DummyDatasetConfig.num_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummyDatasetConfig.sample_definition"><code class="docutils literal notranslate"><span class="pre">DummyDatasetConfig.sample_definition</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleConfig"><code class="docutils literal notranslate"><span class="pre">DummySampleConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleConfig.model_config"><code class="docutils literal notranslate"><span class="pre">DummySampleConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleConfig.sample_key"><code class="docutils literal notranslate"><span class="pre">DummySampleConfig.sample_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleConfig.sample_shape"><code class="docutils literal notranslate"><span class="pre">DummySampleConfig.sample_shape</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleConfig.sample_type"><code class="docutils literal notranslate"><span class="pre">DummySampleConfig.sample_type</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleDataType"><code class="docutils literal notranslate"><span class="pre">DummySampleDataType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleDataType.FLOAT"><code class="docutils literal notranslate"><span class="pre">DummySampleDataType.FLOAT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.DummySampleDataType.INT"><code class="docutils literal notranslate"><span class="pre">DummySampleDataType.INT</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.MemMapDataset"><code class="docutils literal notranslate"><span class="pre">MemMapDataset</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.DATA_SECTION_LENGTH_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.DATA_SECTION_LENGTH_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.HEADER_SIZE_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.HEADER_SIZE_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.TOKEN_SIZE_DESCRIPTOR_LENGTH_IN_BYTES"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.TOKEN_SIZE_DESCRIPTOR_LENGTH_IN_BYTES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.np_dtype_of_tokens_on_disk_from_bytes"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.np_dtype_of_tokens_on_disk_from_bytes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.token_size_in_bytes"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.token_size_in_bytes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetBase.type_converter_for_torch"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetBase.type_converter_for_torch</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetContinuous"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetContinuous</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset.PackedMemMapDatasetMegatron"><code class="docutils literal notranslate"><span class="pre">PackedMemMapDatasetMegatron</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.dataset_factory">modalities.dataloader.dataset_factory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory"><code class="docutils literal notranslate"><span class="pre">DatasetFactory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_combined_dataset"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_combined_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_dummy_dataset"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_dummy_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_mem_map_dataset"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_mem_map_dataset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_packed_mem_map_dataset_continuous"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_packed_mem_map_dataset_continuous()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_packed_mem_map_dataset_megatron"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_packed_mem_map_dataset_megatron()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataset_factory.DatasetFactory.get_raw_index"><code class="docutils literal notranslate"><span class="pre">DatasetFactory.get_raw_index()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.large_file_lines_reader">modalities.dataloader.large_file_lines_reader module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.large_file_lines_reader.BaseReader"><code class="docutils literal notranslate"><span class="pre">BaseReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.large_file_lines_reader.LargeFileLinesReader"><code class="docutils literal notranslate"><span class="pre">LargeFileLinesReader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.large_file_lines_reader.LargeFileLinesReader.close"><code class="docutils literal notranslate"><span class="pre">LargeFileLinesReader.close()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.large_file_lines_reader.LargeFileLinesReader.default_index_path"><code class="docutils literal notranslate"><span class="pre">LargeFileLinesReader.default_index_path()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader.samplers">modalities.dataloader.samplers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.samplers.ResumableDistributedSampler"><code class="docutils literal notranslate"><span class="pre">ResumableDistributedSampler</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.dataloader.html#module-modalities.dataloader">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.inference.html">modalities.inference package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.inference.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.inference.text.html">modalities.inference.text package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.text.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.text.html#module-modalities.inference.text.config">modalities.inference.text.config module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.text.html#module-modalities.inference.text.inference_component">modalities.inference.text.inference_component module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.inference.text.html#module-modalities.inference.text">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.inference.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.inference.html#module-modalities.inference.inference">modalities.inference.inference module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.inference.html#modalities.inference.inference.generate_text"><code class="docutils literal notranslate"><span class="pre">generate_text()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.inference.html#module-modalities.inference">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.logging_broker.html">modalities.logging_broker package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html">modalities.logging_broker.subscriber_impl package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html#module-modalities.logging_broker.subscriber_impl.progress_subscriber">modalities.logging_broker.subscriber_impl.progress_subscriber module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html#module-modalities.logging_broker.subscriber_impl.results_subscriber">modalities.logging_broker.subscriber_impl.results_subscriber module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html#module-modalities.logging_broker.subscriber_impl.subscriber_factory">modalities.logging_broker.subscriber_impl.subscriber_factory module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.subscriber_impl.html#module-modalities.logging_broker.subscriber_impl">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#module-modalities.logging_broker.message_broker">modalities.logging_broker.message_broker module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBroker"><code class="docutils literal notranslate"><span class="pre">MessageBroker</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBroker.add_subscriber"><code class="docutils literal notranslate"><span class="pre">MessageBroker.add_subscriber()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBroker.distribute_message"><code class="docutils literal notranslate"><span class="pre">MessageBroker.distribute_message()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBrokerIF"><code class="docutils literal notranslate"><span class="pre">MessageBrokerIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBrokerIF.add_subscriber"><code class="docutils literal notranslate"><span class="pre">MessageBrokerIF.add_subscriber()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.message_broker.MessageBrokerIF.distribute_message"><code class="docutils literal notranslate"><span class="pre">MessageBrokerIF.distribute_message()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#module-modalities.logging_broker.messages">modalities.logging_broker.messages module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ExperimentStatus"><code class="docutils literal notranslate"><span class="pre">ExperimentStatus</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ExperimentStatus.EVALUATION"><code class="docutils literal notranslate"><span class="pre">ExperimentStatus.EVALUATION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ExperimentStatus.TRAIN"><code class="docutils literal notranslate"><span class="pre">ExperimentStatus.TRAIN</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.Message"><code class="docutils literal notranslate"><span class="pre">Message</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.Message.global_rank"><code class="docutils literal notranslate"><span class="pre">Message.global_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.Message.local_rank"><code class="docutils literal notranslate"><span class="pre">Message.local_rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.Message.message_type"><code class="docutils literal notranslate"><span class="pre">Message.message_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.Message.payload"><code class="docutils literal notranslate"><span class="pre">Message.payload</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.MessageTypes"><code class="docutils literal notranslate"><span class="pre">MessageTypes</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.MessageTypes.BATCH_PROGRESS_UPDATE"><code class="docutils literal notranslate"><span class="pre">MessageTypes.BATCH_PROGRESS_UPDATE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.MessageTypes.ERROR_MESSAGE"><code class="docutils literal notranslate"><span class="pre">MessageTypes.ERROR_MESSAGE</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.MessageTypes.EVALUATION_RESULT"><code class="docutils literal notranslate"><span class="pre">MessageTypes.EVALUATION_RESULT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.MessageTypes.HIGH_LEVEL_PROGRESS_UPDATE"><code class="docutils literal notranslate"><span class="pre">MessageTypes.HIGH_LEVEL_PROGRESS_UPDATE</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ProgressUpdate"><code class="docutils literal notranslate"><span class="pre">ProgressUpdate</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ProgressUpdate.dataloader_tag"><code class="docutils literal notranslate"><span class="pre">ProgressUpdate.dataloader_tag</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ProgressUpdate.experiment_status"><code class="docutils literal notranslate"><span class="pre">ProgressUpdate.experiment_status</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ProgressUpdate.num_steps_done"><code class="docutils literal notranslate"><span class="pre">ProgressUpdate.num_steps_done</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#module-modalities.logging_broker.publisher">modalities.logging_broker.publisher module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisher"><code class="docutils literal notranslate"><span class="pre">MessagePublisher</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisher.publish_message"><code class="docutils literal notranslate"><span class="pre">MessagePublisher.publish_message()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisherIF"><code class="docutils literal notranslate"><span class="pre">MessagePublisherIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisherIF.publish_message"><code class="docutils literal notranslate"><span class="pre">MessagePublisherIF.publish_message()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#module-modalities.logging_broker.subscriber">modalities.logging_broker.subscriber module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.subscriber.MessageSubscriberIF"><code class="docutils literal notranslate"><span class="pre">MessageSubscriberIF</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.subscriber.MessageSubscriberIF.consume_dict"><code class="docutils literal notranslate"><span class="pre">MessageSubscriberIF.consume_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.subscriber.MessageSubscriberIF.consume_message"><code class="docutils literal notranslate"><span class="pre">MessageSubscriberIF.consume_message()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.logging_broker.html#module-modalities.logging_broker">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.models.html">modalities.models package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.coca.html">modalities.models.coca package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca.attention_pooling">modalities.models.coca.attention_pooling module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca.coca_model">modalities.models.coca.coca_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca.collator">modalities.models.coca.collator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca.multi_modal_decoder">modalities.models.coca.multi_modal_decoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca.text_decoder">modalities.models.coca.text_decoder module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.coca.html#module-modalities.models.coca">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.components.html">modalities.models.components package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.components.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.components.html#module-modalities.models.components.layer_norms">modalities.models.components.layer_norms module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.components.html#module-modalities.models.components">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.gpt2.html">modalities.models.gpt2 package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.gpt2.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.gpt2.html#module-modalities.models.gpt2.collator">modalities.models.gpt2.collator module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.gpt2.html#module-modalities.models.gpt2.gpt2_model">modalities.models.gpt2.gpt2_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.gpt2.html#modalities-models-gpt2-pretrained-gpt-model-module">modalities.models.gpt2.pretrained_gpt_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.gpt2.html#module-modalities.models.gpt2">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.huggingface.html">modalities.models.huggingface package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface.html#module-modalities.models.huggingface.huggingface_model">modalities.models.huggingface.huggingface_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface.html#module-modalities.models.huggingface">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.huggingface_adapters.html">modalities.models.huggingface_adapters package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface_adapters.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface_adapters.html#module-modalities.models.huggingface_adapters.hf_adapter">modalities.models.huggingface_adapters.hf_adapter module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.huggingface_adapters.html#module-modalities.models.huggingface_adapters">Module contents</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.vision_transformer.html">modalities.models.vision_transformer package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.vision_transformer.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.vision_transformer.html#module-modalities.models.vision_transformer.vision_transformer_model">modalities.models.vision_transformer.vision_transformer_model module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.vision_transformer.html#module-modalities.models.vision_transformer">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#module-modalities.models.model">modalities.models.model module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.model.ActivationType"><code class="docutils literal notranslate"><span class="pre">ActivationType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.ActivationType.GELU"><code class="docutils literal notranslate"><span class="pre">ActivationType.GELU</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.ActivationType.SWIGLU"><code class="docutils literal notranslate"><span class="pre">ActivationType.SWIGLU</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.model.NNModel"><code class="docutils literal notranslate"><span class="pre">NNModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.NNModel.forward"><code class="docutils literal notranslate"><span class="pre">NNModel.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.NNModel.get_parameters"><code class="docutils literal notranslate"><span class="pre">NNModel.get_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.NNModel.weight_decay_groups"><code class="docutils literal notranslate"><span class="pre">NNModel.weight_decay_groups</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.model.SwiGLU"><code class="docutils literal notranslate"><span class="pre">SwiGLU</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model.SwiGLU.forward"><code class="docutils literal notranslate"><span class="pre">SwiGLU.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.model.model_predict_batch"><code class="docutils literal notranslate"><span class="pre">model_predict_batch()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#module-modalities.models.model_factory">modalities.models.model_factory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.model_factory.ModelFactory"><code class="docutils literal notranslate"><span class="pre">ModelFactory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model_factory.ModelFactory.get_activation_checkpointed_model"><code class="docutils literal notranslate"><span class="pre">ModelFactory.get_activation_checkpointed_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model_factory.ModelFactory.get_checkpointed_model"><code class="docutils literal notranslate"><span class="pre">ModelFactory.get_checkpointed_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model_factory.ModelFactory.get_fsdp_wrapped_model"><code class="docutils literal notranslate"><span class="pre">ModelFactory.get_fsdp_wrapped_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.model_factory.ModelFactory.get_weight_initalized_model"><code class="docutils literal notranslate"><span class="pre">ModelFactory.get_weight_initalized_model()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#module-modalities.models.utils">modalities.models.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.utils.ModelTypeEnum"><code class="docutils literal notranslate"><span class="pre">ModelTypeEnum</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.utils.ModelTypeEnum.CHECKPOINTED_MODEL"><code class="docutils literal notranslate"><span class="pre">ModelTypeEnum.CHECKPOINTED_MODEL</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.models.html#modalities.models.utils.ModelTypeEnum.MODEL"><code class="docutils literal notranslate"><span class="pre">ModelTypeEnum.MODEL</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.models.html#modalities.models.utils.get_model_from_config"><code class="docutils literal notranslate"><span class="pre">get_model_from_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.models.html#module-modalities.models">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.nn.html">modalities.nn package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.nn.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.model_initialization.html">modalities.nn.model_initialization package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#module-modalities.nn.model_initialization.composed_initialization">modalities.nn.model_initialization.composed_initialization module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#module-modalities.nn.model_initialization.initialization_if">modalities.nn.model_initialization.initialization_if module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#module-modalities.nn.model_initialization.initialization_routines">modalities.nn.model_initialization.initialization_routines module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#module-modalities.nn.model_initialization.parameter_name_filters">modalities.nn.model_initialization.parameter_name_filters module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.model_initialization.html#module-modalities.nn.model_initialization">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.nn.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.nn.html#module-modalities.nn.attention">modalities.nn.attention module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionConfig"><code class="docutils literal notranslate"><span class="pre">AttentionConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionConfig.attention_engine_type"><code class="docutils literal notranslate"><span class="pre">AttentionConfig.attention_engine_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionConfig.model_config"><code class="docutils literal notranslate"><span class="pre">AttentionConfig.model_config</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionEngineType"><code class="docutils literal notranslate"><span class="pre">AttentionEngineType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionEngineType.DEFAULT_ATTENTION"><code class="docutils literal notranslate"><span class="pre">AttentionEngineType.DEFAULT_ATTENTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionEngineType.PYTORCH_FLASH_ATTENTION"><code class="docutils literal notranslate"><span class="pre">AttentionEngineType.PYTORCH_FLASH_ATTENTION</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionType"><code class="docutils literal notranslate"><span class="pre">AttentionType</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionType.CAUSAL_SELF_ATTENTION"><code class="docutils literal notranslate"><span class="pre">AttentionType.CAUSAL_SELF_ATTENTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionType.CROSS_ATTENTION"><code class="docutils literal notranslate"><span class="pre">AttentionType.CROSS_ATTENTION</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.AttentionType.NON_CAUSAL_SELF_ATTENTION"><code class="docutils literal notranslate"><span class="pre">AttentionType.NON_CAUSAL_SELF_ATTENTION</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.MultiHeadAttention"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.attention.MultiHeadAttention.forward"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttention.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.nn.html#module-modalities.nn.mlp">modalities.nn.mlp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.nn.html#modalities.nn.mlp.MLP"><code class="docutils literal notranslate"><span class="pre">MLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.nn.html#modalities.nn.mlp.MLP.forward"><code class="docutils literal notranslate"><span class="pre">MLP.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.nn.html#module-modalities.nn">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.optimizers.html">modalities.optimizers package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.optimizers.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.optimizers.html#module-modalities.optimizers.lr_schedulers">modalities.optimizers.lr_schedulers module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.lr_schedulers.DummyLRScheduler"><code class="docutils literal notranslate"><span class="pre">DummyLRScheduler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.lr_schedulers.DummyLRScheduler.get_lr"><code class="docutils literal notranslate"><span class="pre">DummyLRScheduler.get_lr()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.optimizers.html#module-modalities.optimizers.optimizer_factory">modalities.optimizers.optimizer_factory module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_factory.OptimizerFactory"><code class="docutils literal notranslate"><span class="pre">OptimizerFactory</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_factory.OptimizerFactory.get_adam"><code class="docutils literal notranslate"><span class="pre">OptimizerFactory.get_adam()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_factory.OptimizerFactory.get_adam_w"><code class="docutils literal notranslate"><span class="pre">OptimizerFactory.get_adam_w()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_factory.OptimizerFactory.get_checkpointed_optimizer"><code class="docutils literal notranslate"><span class="pre">OptimizerFactory.get_checkpointed_optimizer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.optimizers.html#modalities.optimizers.optimizer_factory.get_optimizer_groups"><code class="docutils literal notranslate"><span class="pre">get_optimizer_groups()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.optimizers.html#module-modalities.optimizers">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.preprocessing.html">modalities.preprocessing package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.preprocessing.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.preprocessing.html#module-modalities.preprocessing.create_chunks">modalities.preprocessing.create_chunks module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.create_chunks.Chunking"><code class="docutils literal notranslate"><span class="pre">Chunking</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.create_chunks.Chunking.get_jsonl_file_chunk"><code class="docutils literal notranslate"><span class="pre">Chunking.get_jsonl_file_chunk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.create_chunks.Chunking.get_tokenized_file_chunk"><code class="docutils literal notranslate"><span class="pre">Chunking.get_tokenized_file_chunk()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.create_chunks.Chunking.shuffle_file_chunks_in_place"><code class="docutils literal notranslate"><span class="pre">Chunking.shuffle_file_chunks_in_place()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.preprocessing.html#module-modalities.preprocessing.shuffle_data">modalities.preprocessing.shuffle_data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.shuffle_data.DataShuffler"><code class="docutils literal notranslate"><span class="pre">DataShuffler</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.shuffle_data.DataShuffler.shuffle_jsonl_data"><code class="docutils literal notranslate"><span class="pre">DataShuffler.shuffle_jsonl_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.preprocessing.html#modalities.preprocessing.shuffle_data.DataShuffler.shuffle_tokenized_data"><code class="docutils literal notranslate"><span class="pre">DataShuffler.shuffle_tokenized_data()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.preprocessing.html#module-modalities.preprocessing">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.registry.html">modalities.registry package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.registry.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.registry.html#module-modalities.registry.components">modalities.registry.components module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.registry.html#modalities.registry.components.ComponentEntity"><code class="docutils literal notranslate"><span class="pre">ComponentEntity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.registry.html#modalities.registry.components.ComponentEntity.component_config_type"><code class="docutils literal notranslate"><span class="pre">ComponentEntity.component_config_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.registry.html#modalities.registry.components.ComponentEntity.component_key"><code class="docutils literal notranslate"><span class="pre">ComponentEntity.component_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.registry.html#modalities.registry.components.ComponentEntity.component_type"><code class="docutils literal notranslate"><span class="pre">ComponentEntity.component_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.registry.html#modalities.registry.components.ComponentEntity.variant_key"><code class="docutils literal notranslate"><span class="pre">ComponentEntity.variant_key</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.registry.html#module-modalities.registry.registry">modalities.registry.registry module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.registry.html#modalities.registry.registry.Registry"><code class="docutils literal notranslate"><span class="pre">Registry</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.registry.html#modalities.registry.registry.Registry.add_entity"><code class="docutils literal notranslate"><span class="pre">Registry.add_entity()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.registry.html#modalities.registry.registry.Registry.get_component"><code class="docutils literal notranslate"><span class="pre">Registry.get_component()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.registry.html#modalities.registry.registry.Registry.get_config"><code class="docutils literal notranslate"><span class="pre">Registry.get_config()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.registry.html#module-modalities.registry">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.running_env.html">modalities.running_env package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.running_env.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.fsdp.html">modalities.running_env.fsdp package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.fsdp.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.fsdp.html#module-modalities.running_env.fsdp.fsdp_auto_wrapper">modalities.running_env.fsdp.fsdp_auto_wrapper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.fsdp.html#module-modalities.running_env.fsdp.reducer">modalities.running_env.fsdp.reducer module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.fsdp.html#module-modalities.running_env.fsdp">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.running_env.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.running_env.html#module-modalities.running_env.cuda_env">modalities.running_env.cuda_env module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.cuda_env.CudaEnv"><code class="docutils literal notranslate"><span class="pre">CudaEnv</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.running_env.html#module-modalities.running_env.env_utils">modalities.running_env.env_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.BF_16"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.BF_16</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.BF_16_WORKING"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.BF_16_WORKING</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.FP_16"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.FP_16</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.FP_32"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.FP_32</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.MIXED_PRECISION_MEGATRON"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.MIXED_PRECISION_MEGATRON</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.MixedPrecisionSettings.NO_MIXED_PRECISION"><code class="docutils literal notranslate"><span class="pre">MixedPrecisionSettings.NO_MIXED_PRECISION</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.has_bfloat_support"><code class="docutils literal notranslate"><span class="pre">has_bfloat_support()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.running_env.html#modalities.running_env.env_utils.is_running_with_torchrun"><code class="docutils literal notranslate"><span class="pre">is_running_with_torchrun()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.running_env.html#module-modalities.running_env">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.tokenization.html">modalities.tokenization package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.tokenization.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.tokenization.html#module-modalities.tokenization.tokenizer_wrapper">modalities.tokenization.tokenizer_wrapper module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.decode"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.get_token_id"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.get_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.is_special_token_id"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.is_special_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.special_tokens"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.special_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.tokenize"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.tokenize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedHFTokenizer.vocab_size"><code class="docutils literal notranslate"><span class="pre">PreTrainedHFTokenizer.vocab_size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer.decode"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer.get_token_id"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer.get_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer.is_special_token_id"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer.is_special_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer.tokenize"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer.tokenize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.PreTrainedSPTokenizer.vocab_size"><code class="docutils literal notranslate"><span class="pre">PreTrainedSPTokenizer.vocab_size</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper.decode"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper.decode()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper.get_token_id"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper.get_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper.is_special_token_id"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper.is_special_token_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper.tokenize"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper.tokenize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.tokenization.html#modalities.tokenization.tokenizer_wrapper.TokenizerWrapper.vocab_size"><code class="docutils literal notranslate"><span class="pre">TokenizerWrapper.vocab_size</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.tokenization.html#module-modalities.tokenization">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.training.html">modalities.training package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.training.html#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.training.gradient_clipping.html">modalities.training.gradient_clipping package</a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.gradient_clipping.html#submodules">Submodules</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.gradient_clipping.html#module-modalities.training.gradient_clipping.fsdp_gradient_clipper">modalities.training.gradient_clipping.fsdp_gradient_clipper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.gradient_clipping.html#module-modalities.training.gradient_clipping.fsdp_gradient_clipper_config">modalities.training.gradient_clipping.fsdp_gradient_clipper_config module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.gradient_clipping.html#module-modalities.training.gradient_clipping.gradient_clipper">modalities.training.gradient_clipping.gradient_clipper module</a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.gradient_clipping.html#module-modalities.training.gradient_clipping">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.training.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.training.html#module-modalities.training.activation_checkpointing">modalities.training.activation_checkpointing module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.training.html#modalities.training.activation_checkpointing.apply_activation_checkpointing_inplace"><code class="docutils literal notranslate"><span class="pre">apply_activation_checkpointing_inplace()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.training.html#modalities.training.activation_checkpointing.is_module_to_apply_activation_checkpointing"><code class="docutils literal notranslate"><span class="pre">is_module_to_apply_activation_checkpointing()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.training.html#module-modalities.training.training_progress">modalities.training.training_progress module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress"><code class="docutils literal notranslate"><span class="pre">TrainingProgress</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_steps_current_run"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_steps_current_run</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_steps_previous_run"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_steps_previous_run</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_steps_total"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_steps_total</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_tokens_current_run"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_tokens_current_run</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_tokens_previous_run"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_tokens_previous_run</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_seen_tokens_total"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_seen_tokens_total</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_target_steps"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_target_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress.num_target_tokens"><code class="docutils literal notranslate"><span class="pre">TrainingProgress.num_target_tokens</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.training.html#module-modalities.training">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modalities.utils.html">modalities.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.logging">modalities.utils.logging module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.logging.get_logger"><code class="docutils literal notranslate"><span class="pre">get_logger()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.mfu">modalities.utils.mfu module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.mfu.compute_mfu"><code class="docutils literal notranslate"><span class="pre">compute_mfu()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.mfu.get_theoretical_flops_per_token"><code class="docutils literal notranslate"><span class="pre">get_theoretical_flops_per_token()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.mfu.get_theoretical_gpu_peak_performance"><code class="docutils literal notranslate"><span class="pre">get_theoretical_gpu_peak_performance()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.number_conversion">modalities.utils.number_conversion module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumSamplesConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.global_num_samples"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumSamplesConfig.global_num_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumSamplesConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.model_config"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumSamplesConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumSamplesConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumSamplesConfig.num_ranks</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.global_num_tokens"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig.global_num_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.model_config"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig.num_ranks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.LocalNumBatchesFromNumTokensConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">LocalNumBatchesFromNumTokensConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig"><code class="docutils literal notranslate"><span class="pre">NumSamplesFromNumTokensConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumSamplesFromNumTokensConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.num_tokens"><code class="docutils literal notranslate"><span class="pre">NumSamplesFromNumTokensConfig.num_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumSamplesFromNumTokensConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">NumSamplesFromNumTokensConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.global_num_samples"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig.global_num_samples</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumSamplesConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumSamplesConfig.num_ranks</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.global_num_tokens"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.global_num_tokens</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.num_ranks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromNumTokensConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">NumStepsFromNumTokensConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig.num_ranks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumStepsFromRawDatasetIndexConfig.raw_index_path"><code class="docutils literal notranslate"><span class="pre">NumStepsFromRawDatasetIndexConfig.raw_index_path</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.num_ranks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.num_steps"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.num_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromNumStepsConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">NumTokensFromNumStepsConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.dataset_path"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.dataset_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.gradient_accumulation_steps"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.gradient_accumulation_steps</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.local_micro_batch_size"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.local_micro_batch_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.model_config</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.num_ranks"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.num_ranks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumTokensFromPackedMemMapDatasetContinuousConfig.sequence_length"><code class="docutils literal notranslate"><span class="pre">NumTokensFromPackedMemMapDatasetContinuousConfig.sequence_length</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion"><code class="docutils literal notranslate"><span class="pre">NumberConversion</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_global_num_seen_tokens_from_checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_global_num_seen_tokens_from_checkpoint_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_global_num_target_tokens_from_checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_global_num_target_tokens_from_checkpoint_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_last_step_from_checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_last_step_from_checkpoint_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_local_num_batches_from_num_samples"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_local_num_batches_from_num_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_local_num_batches_from_num_tokens"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_local_num_batches_from_num_tokens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_samples_from_num_tokens"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_samples_from_num_tokens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_seen_steps_from_checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_seen_steps_from_checkpoint_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_steps_from_num_samples"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_steps_from_num_samples()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_steps_from_num_tokens"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_steps_from_num_tokens()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_steps_from_raw_dataset_index"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_steps_from_raw_dataset_index()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_target_steps_from_checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_target_steps_from_checkpoint_path()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_tokens_from_num_steps"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_tokens_from_num_steps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversion.get_num_tokens_from_packed_mem_map_dataset_continuous"><code class="docutils literal notranslate"><span class="pre">NumberConversion.get_num_tokens_from_packed_mem_map_dataset_continuous()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig"><code class="docutils literal notranslate"><span class="pre">NumberConversionFromCheckpointPathConfig</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig.checkpoint_path"><code class="docutils literal notranslate"><span class="pre">NumberConversionFromCheckpointPathConfig.checkpoint_path</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.number_conversion.NumberConversionFromCheckpointPathConfig.model_config"><code class="docutils literal notranslate"><span class="pre">NumberConversionFromCheckpointPathConfig.model_config</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.seeding">modalities.utils.seeding module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.seeding.calculate_hashed_seed"><code class="docutils literal notranslate"><span class="pre">calculate_hashed_seed()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils.verify_tokenization_consistency">modalities.utils.verify_tokenization_consistency module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.verify_tokenization_consistency.TokenizerTypes"><code class="docutils literal notranslate"><span class="pre">TokenizerTypes</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.verify_tokenization_consistency.TokenizerTypes.hugging_face"><code class="docutils literal notranslate"><span class="pre">TokenizerTypes.hugging_face</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="modalities.utils.html#modalities.utils.verify_tokenization_consistency.TokenizerTypes.sentence_piece"><code class="docutils literal notranslate"><span class="pre">TokenizerTypes.sentence_piece</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.verify_tokenization_consistency.build_hf_tokenization_components"><code class="docutils literal notranslate"><span class="pre">build_hf_tokenization_components()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.verify_tokenization_consistency.build_sp_tokenization_components"><code class="docutils literal notranslate"><span class="pre">build_sp_tokenization_components()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="modalities.utils.html#modalities.utils.verify_tokenization_consistency.verify_tokenization_consistency"><code class="docutils literal notranslate"><span class="pre">verify_tokenization_consistency()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="modalities.utils.html#module-modalities.utils">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-modalities.api">
<span id="modalities-api-module"></span><h2>modalities.api module<a class="headerlink" href="#module-modalities.api" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.api.FileExistencePolicy">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">FileExistencePolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#FileExistencePolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.FileExistencePolicy" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.api.FileExistencePolicy.ERROR">
<span class="sig-name descname"><span class="pre">ERROR</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'error'</span></em><a class="headerlink" href="#modalities.api.FileExistencePolicy.ERROR" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.api.FileExistencePolicy.OVERRIDE">
<span class="sig-name descname"><span class="pre">OVERRIDE</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'override'</span></em><a class="headerlink" href="#modalities.api.FileExistencePolicy.OVERRIDE" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.api.FileExistencePolicy.SKIP">
<span class="sig-name descname"><span class="pre">SKIP</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'skip'</span></em><a class="headerlink" href="#modalities.api.FileExistencePolicy.SKIP" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.convert_pytorch_to_hf_checkpoint">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">convert_pytorch_to_hf_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_hf_checkpoint_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#convert_pytorch_to_hf_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.convert_pytorch_to_hf_checkpoint" title="Link to this definition"></a></dt>
<dd><p>Converts a PyTorch checkpoint to a Hugging Face checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference internal" href="modalities.models.huggingface_adapters.html#modalities.models.huggingface_adapters.hf_adapter.HFModelAdapter" title="modalities.models.huggingface_adapters.hf_adapter.HFModelAdapter"><code class="xref py py-class docutils literal notranslate"><span class="pre">HFModelAdapter</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>config_file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>output_hf_checkpoint_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>prediction_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>config_file_path (Path): Path to the config that generated the pytorch checkpoint.
output_hf_checkpoint_dir (Path): Path to the output directory for the converted HF checkpoint.
prediction_key (str): The key in the models output where one can find the predictions of interest.</p>
</dd>
<dt>Returns:</dt><dd><p>HFModelAdapter: The Hugging Face model adapter.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.create_filtered_tokenized_dataset">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">create_filtered_tokenized_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_routine</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_existence_policy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#create_filtered_tokenized_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.create_filtered_tokenized_dataset" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>filter_routine</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a><em>]</em>)</p></li>
<li><p><strong>output_data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>file_existence_policy</strong> (<a class="reference internal" href="#modalities.api.FileExistencePolicy" title="modalities.api.FileExistencePolicy"><em>FileExistencePolicy</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.create_raw_data_index">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">create_raw_data_index</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">index_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_existence_policy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">FileExistencePolicy.ERROR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#create_raw_data_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.create_raw_data_index" title="Link to this definition"></a></dt>
<dd><p>Creates the index file for the content of a large jsonl-file. The index file
contains the byte-offsets and lengths of each line in the jsonl-file.
Background is the ability to further process the respective file without loading it,
while splitting its content line-based. This step is necessary in advance of further processing like tokenization.
It is only necessary once for a jsonl-file and allows therefore different tokenizations without re-indexing.</p>
<dl>
<dt>Args:</dt><dd><p>src_path (Path): The path to the jsonl-file.
index_path (Path): The path to the index file, that will be created.
file_existence_policy (FileExistencePolicy): Policy to apply when the index file already exists.</p>
<blockquote>
<div><p>Defaults to FileExistencePolicy.ERROR.</p>
</div></blockquote>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If the index file already exists.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>index_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>file_existence_policy</strong> (<a class="reference internal" href="#modalities.api.FileExistencePolicy" title="modalities.api.FileExistencePolicy"><em>FileExistencePolicy</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.create_shuffled_dataset_chunk">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">create_shuffled_dataset_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_chunk_file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_chunks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_existence_policy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#create_shuffled_dataset_chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.create_shuffled_dataset_chunk" title="Link to this definition"></a></dt>
<dd><p>Creates a shuffled dataset chunk.
Given a dataset consisting of multiple tokenized pbin files, this function
creates a shuffled dataset chunk for a given chunk id.
From each tokenized pbin file, the respective chunk is extracted, shuffled
and written to a new pbin file.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>file_path_list (list[Path]): List of paths to the tokenized input pbin files.
output_chunk_file_path (Path): Path to the output chunk which will be stored in pbin format.
chunk_id (int): The id of the chunk to create.
num_chunks (int): The total number of chunks to create.
file_existence_policy (FileExistencePolicy): Policy to apply when the output chunk file already exists.
global_seed (Optional[int]): The global seed to use for shuffling.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If the chunk has no samples.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a><em>]</em>)</p></li>
<li><p><strong>output_chunk_file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>chunk_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>num_chunks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>file_existence_policy</strong> (<a class="reference internal" href="#modalities.api.FileExistencePolicy" title="modalities.api.FileExistencePolicy"><em>FileExistencePolicy</em></a>)</p></li>
<li><p><strong>global_seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.create_shuffled_jsonl_dataset_chunk">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">create_shuffled_jsonl_dataset_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_chunk_file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_chunks</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_existence_policy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#create_shuffled_jsonl_dataset_chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.create_shuffled_jsonl_dataset_chunk" title="Link to this definition"></a></dt>
<dd><p>Creates a shuffled jsonl dataset chunk.
Given a dataset consisting of multiple jsonl files, this function
creates a shuffled dataset chunk for a given chunk id.
From each jsonl file, the respective chunk is extracted, shuffled
and written to a new jsonl file.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>file_path_list (list[Path]): List of paths to the input jsonl files.
output_chunk_file_path (Path): Path to the output chunk which will be stored in jsonl format.
chunk_id (int): The id of the chunk to create.
num_chunks (int): The total number of chunks to create.
file_existence_policy (FileExistencePolicy): Policy to apply when the output chunk file already exists.
global_seed (Optional[int]): The global seed to use for shuffling.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: If the chunk has no samples.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a><em>]</em>)</p></li>
<li><p><strong>output_chunk_file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>chunk_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>num_chunks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>file_existence_policy</strong> (<a class="reference internal" href="#modalities.api.FileExistencePolicy" title="modalities.api.FileExistencePolicy"><em>FileExistencePolicy</em></a>)</p></li>
<li><p><strong>global_seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.enforce_file_existence_policy">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">enforce_file_existence_policy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_existence_policy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#enforce_file_existence_policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.enforce_file_existence_policy" title="Link to this definition"></a></dt>
<dd><p>Enforces the file existence policy. Function returns True, if processing should be stopped. Otherwise False.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>file_existence_policy</strong> (<a class="reference internal" href="#modalities.api.FileExistencePolicy" title="modalities.api.FileExistencePolicy"><em>FileExistencePolicy</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>file_path (Path): File path to the file to check.
file_existence_policy (FileExistencePolicy): The file existence policy.</p>
</dd>
<dt>Raises:</dt><dd><p>ValueError: Raised if the file existence policy is unknown or the policy requires to raise a ValueError.</p>
</dd>
<dt>Returns:</dt><dd><p>bool: True if processing should be stopped, otherwise False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.generate_text">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">generate_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_file_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#generate_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.generate_text" title="Link to this definition"></a></dt>
<dd><p>Inference function to generate text with a given model.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>config_file_path (FilePath): Path to the YAML config file.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config_file_path</strong> (<em>Annotated</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a><em>, </em><em>PathType</em><em>(</em><em>path_type=file</em><em>)</em><em>]</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.merge_packed_data_files">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">merge_packed_data_files</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#merge_packed_data_files"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.merge_packed_data_files" title="Link to this definition"></a></dt>
<dd><p>Utility function for merging different pbin-files into one.
This is especially useful, if different datasets were at different points in time or if one encoding takes so long,
that the overall process was done in chunks.
It is important that the same tokenizer got used for all chunks.</p>
<p>Specify an arbitrary amount of pbin-files and/or directory containing such as input.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>src_paths (list[Path]): List of paths to the pbin-files or directories containing such.
target_path (Path): The path to the merged pbin-file, that will be created.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src_paths</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a><em>]</em>)</p></li>
<li><p><strong>target_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.pack_encoded_data">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">pack_encoded_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_existence_policy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#pack_encoded_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.pack_encoded_data" title="Link to this definition"></a></dt>
<dd><p>Packs and encodes an indexed, large jsonl-file.
(see also <cite>create_index</cite> for more information)
Returns .pbin-file, which can be inserted into a training process directly
and does not require its original jsonl-file or the respective index file anymore.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>config_dict (dict): Dictionary containing the configuration for the packed data generation.
file_existence_policy (FileExistencePolicy): Policy to apply when the output file already exists.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a>)</p></li>
<li><p><strong>file_existence_policy</strong> (<a class="reference internal" href="#modalities.api.FileExistencePolicy" title="modalities.api.FileExistencePolicy"><em>FileExistencePolicy</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.shuffle_jsonl_data">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">shuffle_jsonl_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_existence_policy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#shuffle_jsonl_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.shuffle_jsonl_data" title="Link to this definition"></a></dt>
<dd><p>Shuffles a JSONL file (.jsonl) and stores it on disc.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>input_data_path (Path): File path to the jsonl data (.jsonl).
output_data_path (Path): File path to write the shuffled jsonl data.
file_existence_policy (FileExistencePolicy): Policy to apply when the output file already exists.
seed (Optional[int]): The seed to use for shuffling.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>output_data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>file_existence_policy</strong> (<a class="reference internal" href="#modalities.api.FileExistencePolicy" title="modalities.api.FileExistencePolicy"><em>FileExistencePolicy</em></a>)</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.api.shuffle_tokenized_data">
<span class="sig-prename descclassname"><span class="pre">modalities.api.</span></span><span class="sig-name descname"><span class="pre">shuffle_tokenized_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_data_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_existence_policy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/api.html#shuffle_tokenized_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.api.shuffle_tokenized_data" title="Link to this definition"></a></dt>
<dd><p>Shuffles a tokenized file (.pbin) and stores it on disc.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>input_data_path (Path): File path to the tokenized data (.pbin).
output_data_path (Path): File path to write the shuffled tokenized data.
batch_size (int): Number of documents to process per batch.
file_existence_policy (FileExistencePolicy): Policy to apply when the output file already exists.
seed (Optional[int]): The seed to use for shuffling.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>output_data_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>file_existence_policy</strong> (<a class="reference internal" href="#modalities.api.FileExistencePolicy" title="modalities.api.FileExistencePolicy"><em>FileExistencePolicy</em></a>)</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-modalities.batch">
<span id="modalities-batch-module"></span><h2>modalities.batch module<a class="headerlink" href="#module-modalities.batch" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.Batch">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">Batch</span></span><a class="reference internal" href="../_modules/modalities/batch.html#Batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.Batch" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract class that defines the necessary methods any <cite>Batch</cite> implementation needs to implement.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">DatasetBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#DatasetBatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.DatasetBatch" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.batch.Batch" title="modalities.batch.Batch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Batch</span></code></a>, <a class="reference internal" href="#modalities.batch.TorchDeviceMixin" title="modalities.batch.TorchDeviceMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchDeviceMixin</span></code></a></p>
<p>A batch of samples and its targets. Used to batch train a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a><em>]</em>)</p></li>
<li><p><strong>targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a><em>]</em>)</p></li>
<li><p><strong>batch_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.batch_dim">
<span class="sig-name descname"><span class="pre">batch_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#modalities.batch.DatasetBatch.batch_dim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#DatasetBatch.detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.DatasetBatch.detach" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.device">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.7)"><span class="pre">device</span></a></em><a class="headerlink" href="#modalities.batch.DatasetBatch.device" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.samples">
<span class="sig-name descname"><span class="pre">samples</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.batch.DatasetBatch.samples" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.targets">
<span class="sig-name descname"><span class="pre">targets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.batch.DatasetBatch.targets" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.DatasetBatch.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#DatasetBatch.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.DatasetBatch.to" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.7)"><em>device</em></a>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">EvaluationResultBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataloader_tag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_train_steps_done</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">losses=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics=&lt;factory&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">throughput_metrics=&lt;factory&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#EvaluationResultBatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.EvaluationResultBatch" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.batch.Batch" title="modalities.batch.Batch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Batch</span></code></a></p>
<p>Data class for storing the results of a single or multiple batches.
Also entire epoch results are stored in here.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataloader_tag</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>num_train_steps_done</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>losses</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><em>ResultItem</em></a><em>]</em>)</p></li>
<li><p><strong>metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><em>ResultItem</em></a><em>]</em>)</p></li>
<li><p><strong>throughput_metrics</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><em>ResultItem</em></a><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch.dataloader_tag">
<span class="sig-name descname"><span class="pre">dataloader_tag</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></em><a class="headerlink" href="#modalities.batch.EvaluationResultBatch.dataloader_tag" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch.losses">
<span class="sig-name descname"><span class="pre">losses</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResultItem</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.batch.EvaluationResultBatch.losses" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch.metrics">
<span class="sig-name descname"><span class="pre">metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResultItem</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.batch.EvaluationResultBatch.metrics" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch.num_train_steps_done">
<span class="sig-name descname"><span class="pre">num_train_steps_done</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></em><a class="headerlink" href="#modalities.batch.EvaluationResultBatch.num_train_steps_done" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.EvaluationResultBatch.throughput_metrics">
<span class="sig-name descname"><span class="pre">throughput_metrics</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference internal" href="#modalities.batch.ResultItem" title="modalities.batch.ResultItem"><code class="xref py py-class docutils literal notranslate"><span class="pre">ResultItem</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.batch.EvaluationResultBatch.throughput_metrics" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">InferenceResultBatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">targets</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_dim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.batch.Batch" title="modalities.batch.Batch"><code class="xref py py-class docutils literal notranslate"><span class="pre">Batch</span></code></a>, <a class="reference internal" href="#modalities.batch.TorchDeviceMixin" title="modalities.batch.TorchDeviceMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">TorchDeviceMixin</span></code></a></p>
<p>Stores targets and predictions of an entire batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>targets</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a><em>]</em>)</p></li>
<li><p><strong>predictions</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><em>dict</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a><em>]</em>)</p></li>
<li><p><strong>batch_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.batch_dim">
<span class="sig-name descname"><span class="pre">batch_dim</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#modalities.batch.InferenceResultBatch.batch_dim" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.detach">
<span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch.detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch.detach" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.device">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.7)"><span class="pre">device</span></a></em><a class="headerlink" href="#modalities.batch.InferenceResultBatch.device" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.get_predictions">
<span class="sig-name descname"><span class="pre">get_predictions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch.get_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch.get_predictions" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.get_targets">
<span class="sig-name descname"><span class="pre">get_targets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch.get_targets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch.get_targets" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.predictions">
<span class="sig-name descname"><span class="pre">predictions</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.batch.InferenceResultBatch.predictions" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.targets">
<span class="sig-name descname"><span class="pre">targets</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">]</span></em><a class="headerlink" href="#modalities.batch.InferenceResultBatch.targets" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.to">
<span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch.to" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.7)"><em>device</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.InferenceResultBatch.to_cpu">
<span class="sig-name descname"><span class="pre">to_cpu</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#InferenceResultBatch.to_cpu"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.InferenceResultBatch.to_cpu" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.ResultItem">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">ResultItem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decimal_places</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#ResultItem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.ResultItem" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a>)</p></li>
<li><p><strong>decimal_places</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.ResultItem.decimal_places">
<span class="sig-name descname"><span class="pre">decimal_places</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a><span class="pre">]</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#modalities.batch.ResultItem.decimal_places" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.batch.ResultItem.value">
<span class="sig-name descname"><span class="pre">value</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></em><a class="headerlink" href="#modalities.batch.ResultItem.value" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.batch.TorchDeviceMixin">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.batch.</span></span><span class="sig-name descname"><span class="pre">TorchDeviceMixin</span></span><a class="reference internal" href="../_modules/modalities/batch.html#TorchDeviceMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.TorchDeviceMixin" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.TorchDeviceMixin.detach">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">detach</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#TorchDeviceMixin.detach"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.TorchDeviceMixin.detach" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="modalities.batch.TorchDeviceMixin.device">
<em class="property"><span class="k"><span class="pre">abstract</span></span><span class="w"> </span><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">device</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.7)"><span class="pre">device</span></a></em><a class="headerlink" href="#modalities.batch.TorchDeviceMixin.device" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.batch.TorchDeviceMixin.to">
<em class="property"><span class="k"><span class="pre">abstractmethod</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">device</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/batch.html#TorchDeviceMixin.to"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.batch.TorchDeviceMixin.to" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.7)"><em>device</em></a>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-modalities.evaluator">
<span id="modalities-evaluator-module"></span><h2>modalities.evaluator module<a class="headerlink" href="#module-modalities.evaluator" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.evaluator.Evaluator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.evaluator.</span></span><span class="sig-name descname"><span class="pre">Evaluator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">progress_publisher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation_result_publisher</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/evaluator.html#Evaluator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.evaluator.Evaluator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Evaluator class which is responsible for evaluating the model on a set of datasets</p>
<p>Initializes the Evaluator class.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>progress_publisher (MessagePublisher[ProgressUpdate]): Publisher for progress updates
evaluation_result_publisher (MessagePublisher[EvaluationResultBatch]): Publisher for evaluation results</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>progress_publisher</strong> (<a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisher" title="modalities.logging_broker.publisher.MessagePublisher"><em>MessagePublisher</em></a><em>[</em><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ProgressUpdate" title="modalities.logging_broker.messages.ProgressUpdate"><em>ProgressUpdate</em></a><em>]</em>)</p></li>
<li><p><strong>evaluation_result_publisher</strong> (<a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisher" title="modalities.logging_broker.publisher.MessagePublisher"><em>MessagePublisher</em></a><em>[</em><a class="reference internal" href="#modalities.batch.EvaluationResultBatch" title="modalities.batch.EvaluationResultBatch"><em>EvaluationResultBatch</em></a><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.evaluator.Evaluator.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_loaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_train_steps_done</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/evaluator.html#Evaluator.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.evaluator.Evaluator.evaluate" title="Link to this definition"></a></dt>
<dd><p>Evaluate the model on a set of datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference internal" href="#modalities.batch.EvaluationResultBatch" title="modalities.batch.EvaluationResultBatch"><code class="xref py py-class docutils literal notranslate"><span class="pre">EvaluationResultBatch</span></code></a>]</span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.7)"><em>Module</em></a>)</p></li>
<li><p><strong>data_loaders</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader.LLMDataLoader" title="modalities.dataloader.dataloader.LLMDataLoader"><em>LLMDataLoader</em></a><em>]</em>)</p></li>
<li><p><strong>loss_fun</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference internal" href="#modalities.batch.InferenceResultBatch" title="modalities.batch.InferenceResultBatch"><em>InferenceResultBatch</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a><em>]</em>)</p></li>
<li><p><strong>num_train_steps_done</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>model (nn.Module): The model to evaluate
data_loaders (list[LLMDataLoader]): List of dataloaders to evaluate the model on
loss_fun (Callable[[InferenceResultBatch], torch.Tensor]): The loss function to calculate the loss
num_train_steps_done (int): The number of training steps done so far for logging purposes</p>
</dd>
<dt>Returns:</dt><dd><p>dict[str, EvaluationResultBatch]: A dictionary containing the evaluation results for each dataloader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.evaluator.Evaluator.evaluate_batch">
<span class="sig-name descname"><span class="pre">evaluate_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fun</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/evaluator.html#Evaluator.evaluate_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.evaluator.Evaluator.evaluate_batch" title="Link to this definition"></a></dt>
<dd><p>Evaluate a single batch by forwarding it through the model and calculating the loss.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>batch</strong> (<a class="reference internal" href="#modalities.batch.DatasetBatch" title="modalities.batch.DatasetBatch"><em>DatasetBatch</em></a>)</p></li>
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.7)"><em>Module</em></a>)</p></li>
<li><p><strong>loss_fun</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference internal" href="#modalities.batch.InferenceResultBatch" title="modalities.batch.InferenceResultBatch"><em>InferenceResultBatch</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a><em>]</em>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>batch (DatasetBatch): The batch to evaluate
model (nn.Module): The model to evaluate
loss_fun (Callable[[InferenceResultBatch], torch.Tensor]): The loss function to calculate the loss</p>
</dd>
<dt>Returns:</dt><dd><p>torch.Tensor: The loss of the batch</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-modalities.exceptions">
<span id="modalities-exceptions-module"></span><h2>modalities.exceptions module<a class="headerlink" href="#module-modalities.exceptions" title="Link to this heading"></a></h2>
<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.BatchStateError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">BatchStateError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#BatchStateError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.BatchStateError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.CheckpointingError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">CheckpointingError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#CheckpointingError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.CheckpointingError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.ConfigError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">ConfigError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#ConfigError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.ConfigError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.DatasetNotFoundError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">DatasetNotFoundError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#DatasetNotFoundError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.DatasetNotFoundError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.OptimizerError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">OptimizerError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#OptimizerError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.OptimizerError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.RunningEnvError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">RunningEnvError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#RunningEnvError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.RunningEnvError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="modalities.exceptions.TimeRecorderStateError">
<em class="property"><span class="k"><span class="pre">exception</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.exceptions.</span></span><span class="sig-name descname"><span class="pre">TimeRecorderStateError</span></span><a class="reference internal" href="../_modules/modalities/exceptions.html#TimeRecorderStateError"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.exceptions.TimeRecorderStateError" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#Exception" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></a></p>
</dd></dl>

</section>
<section id="module-modalities.gym">
<span id="modalities-gym-module"></span><h2>modalities.gym module<a class="headerlink" href="#module-modalities.gym" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.gym.Gym">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.gym.</span></span><span class="sig-name descname"><span class="pre">Gym</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluator</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_ranks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/gym.html#Gym"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.gym.Gym" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class to perform the model training, including evaluation and checkpointing.</p>
<p>Initializes a Gym object.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>trainer (Trainer): Trainer object to perform the training.
evaluator (Evaluator): Evaluator object to perform the evaluation.
loss_fun (Loss): Loss function applied during training and evaluation.
num_ranks (int): Number of ranks used for distributed training.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<a class="reference internal" href="#modalities.trainer.Trainer" title="modalities.trainer.Trainer"><em>Trainer</em></a>)</p></li>
<li><p><strong>evaluator</strong> (<a class="reference internal" href="#modalities.evaluator.Evaluator" title="modalities.evaluator.Evaluator"><em>Evaluator</em></a>)</p></li>
<li><p><strong>loss_fun</strong> (<a class="reference internal" href="#modalities.loss_functions.Loss" title="modalities.loss_functions.Loss"><em>Loss</em></a>)</p></li>
<li><p><strong>num_ranks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.gym.Gym.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_log_interval_in_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpointing_interval_in_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation_interval_in_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_data_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation_data_loaders</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint_saving</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/gym.html#Gym.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.gym.Gym.run" title="Link to this definition"></a></dt>
<dd><p>Runs the model training, including evaluation and checkpointing.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (nn.Module): Model to be trained.
optimizer (Optimizer): Optimizer used for training.
scheduler (LRScheduler): Scheduler used for training.
training_log_interval_in_steps (int): Interval in steps to log training progress.
checkpointing_interval_in_steps (int): Interval in steps to save checkpoints.
evaluation_interval_in_steps (int): Interval in steps to perform evaluation.
train_data_loader (LLMDataLoader): Data loader with the training data.
evaluation_data_loaders (list[LLMDataLoader]): List of data loaders with the evaluation data.
checkpoint_saving (CheckpointSaving): Routine for saving checkpoints.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.7)"><em>Module</em></a>)</p></li>
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.7)"><em>Optimizer</em></a>)</p></li>
<li><p><strong>scheduler</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.LRScheduler.html#torch.optim.lr_scheduler.LRScheduler" title="(in PyTorch v2.7)"><em>LRScheduler</em></a>)</p></li>
<li><p><strong>training_log_interval_in_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>checkpointing_interval_in_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>evaluation_interval_in_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>train_data_loader</strong> (<a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader.LLMDataLoader" title="modalities.dataloader.dataloader.LLMDataLoader"><em>LLMDataLoader</em></a>)</p></li>
<li><p><strong>evaluation_data_loaders</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><em>list</em></a><em>[</em><a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader.LLMDataLoader" title="modalities.dataloader.dataloader.LLMDataLoader"><em>LLMDataLoader</em></a><em>]</em>)</p></li>
<li><p><strong>checkpoint_saving</strong> (<a class="reference internal" href="modalities.checkpointing.html#modalities.checkpointing.checkpoint_saving.CheckpointSaving" title="modalities.checkpointing.checkpoint_saving.CheckpointSaving"><em>CheckpointSaving</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-modalities.loss_functions">
<span id="modalities-loss-functions-module"></span><h2>modalities.loss_functions module<a class="headerlink" href="#module-modalities.loss_functions" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.loss_functions.CLMCrossEntropyLoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.loss_functions.</span></span><span class="sig-name descname"><span class="pre">CLMCrossEntropyLoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'CLMCrossEntropyLoss'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/loss_functions.html#CLMCrossEntropyLoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.loss_functions.CLMCrossEntropyLoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.loss_functions.Loss" title="modalities.loss_functions.Loss"><code class="xref py py-class docutils literal notranslate"><span class="pre">Loss</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>prediction_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>tag</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.loss_functions.Loss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.loss_functions.</span></span><span class="sig-name descname"><span class="pre">Loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tag</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/loss_functions.html#Loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.loss_functions.Loss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tag</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="modalities.loss_functions.Loss.tag">
<em class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">tag</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><span class="pre">str</span></a></em><a class="headerlink" href="#modalities.loss_functions.Loss.tag" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.loss_functions.NCELoss">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.loss_functions.</span></span><span class="sig-name descname"><span class="pre">NCELoss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prediction_key1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prediction_key2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_asymmetric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'NCELoss'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/loss_functions.html#NCELoss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.loss_functions.NCELoss" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#modalities.loss_functions.Loss" title="modalities.loss_functions.Loss"><code class="xref py py-class docutils literal notranslate"><span class="pre">Loss</span></code></a></p>
<p>Noise Contrastive Estimation Loss</p>
<dl class="simple">
<dt>Args:</dt><dd><p>prediction_key1 (str): key to access embedding 1.
prediction_key2 (str): key to access embedding 2.
is_asymmetric (bool, optional): specifies symmetric or asymmetric calculation of NCEloss. Defaults to True.
temperature (float, optional): temperature. Defaults to 1.0.
tag (str, optional): Defaults to “NCELoss”.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prediction_key1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>prediction_key2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>is_asymmetric</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>temperature</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>tag</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.loss_functions.nce_loss">
<span class="sig-prename descclassname"><span class="pre">modalities.loss_functions.</span></span><span class="sig-name descname"><span class="pre">nce_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">embedding1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_asymmetric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/loss_functions.html#nce_loss"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.loss_functions.nce_loss" title="Link to this definition"></a></dt>
<dd><p>This implementation calculates the noise contrastive estimation loss between embeddings of two different modalities
Implementation slightly adapted from <a class="reference external" href="https://arxiv.org/pdf/1912.06430.pdf">https://arxiv.org/pdf/1912.06430.pdf</a>, <a class="reference external" href="https://github.com/antoine77340/MIL-NCE_HowTo100M">https://github.com/antoine77340/MIL-NCE_HowTo100M</a>
changes include adding a temperature value and the choice of calculating asymmetric loss w.r.t. one modality
This implementation is adapted to contrastive loss from CoCa model <a class="reference external" href="https://arxiv.org/pdf/2205.01917.pdf">https://arxiv.org/pdf/2205.01917.pdf</a></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>embedding1</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a>)</p></li>
<li><p><strong>embedding2</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a>)</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensor_attributes.html#torch.device" title="(in PyTorch v2.7)"><em>device</em></a>)</p></li>
<li><p><strong>is_asymmetric</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><em>bool</em></a>)</p></li>
<li><p><strong>temperature</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>embedding1 (torch.Tensor): embeddings from modality 1 of size batch_size x embed_dim.
embedding2 (torch.Tensor): embeddings from modality 2 of size batch_size x embed_dim.
device (torch.device): torch device for calculating loss.
is_asymmetric (bool): boolean value to specify if the loss is calculated in one direction or both directions.
temperature (float): temperature value for regulating loss.</p>
</dd>
<dt>Returns:</dt><dd><p>torch.Tensor: loss tensor.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-modalities.trainer">
<span id="modalities-trainer-module"></span><h2>modalities.trainer module<a class="headerlink" href="#module-modalities.trainer" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.trainer.ThroughputAggregationKeys">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.trainer.</span></span><span class="sig-name descname"><span class="pre">ThroughputAggregationKeys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/trainer.html#ThroughputAggregationKeys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.trainer.ThroughputAggregationKeys" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.trainer.ThroughputAggregationKeys.FORWARD_BACKWARD_TIME">
<span class="sig-name descname"><span class="pre">FORWARD_BACKWARD_TIME</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'FORWARD_BACKWARD_TIME'</span></em><a class="headerlink" href="#modalities.trainer.ThroughputAggregationKeys.FORWARD_BACKWARD_TIME" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.trainer.ThroughputAggregationKeys.NUM_SAMPLES">
<span class="sig-name descname"><span class="pre">NUM_SAMPLES</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'NUM_SAMPLES'</span></em><a class="headerlink" href="#modalities.trainer.ThroughputAggregationKeys.NUM_SAMPLES" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.trainer.Trainer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.trainer.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_rank</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_publisher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation_result_publisher</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_acc_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_num_tokens_per_train_step</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_seen_train_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_num_seen_tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_target_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_target_tokens</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_clipper</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/trainer.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.trainer.Trainer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Initializes the Trainer object.</p>
<dl>
<dt>Args:</dt><dd><p>global_rank (int): The global rank to which operates the trainer object.
progress_publisher (MessagePublisher[ProgressUpdate]): The publisher for progress updates.
evaluation_result_publisher (MessagePublisher[EvaluationResultBatch]):</p>
<blockquote>
<div><p>The publisher for evaluation result batches.</p>
</div></blockquote>
<p>gradient_acc_steps (int): The number of gradient accumulation steps.
global_num_tokens_per_train_step (int): The number of global tokens per training step.
target_train_steps (int): The target number of training steps.
gradient_clipper (GradientClipperIF): The gradient clipper.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>global_rank</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>progress_publisher</strong> (<a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisher" title="modalities.logging_broker.publisher.MessagePublisher"><em>MessagePublisher</em></a><em>[</em><a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.messages.ProgressUpdate" title="modalities.logging_broker.messages.ProgressUpdate"><em>ProgressUpdate</em></a><em>]</em>)</p></li>
<li><p><strong>evaluation_result_publisher</strong> (<a class="reference internal" href="modalities.logging_broker.html#modalities.logging_broker.publisher.MessagePublisher" title="modalities.logging_broker.publisher.MessagePublisher"><em>MessagePublisher</em></a><em>[</em><a class="reference internal" href="#modalities.batch.EvaluationResultBatch" title="modalities.batch.EvaluationResultBatch"><em>EvaluationResultBatch</em></a><em>]</em>)</p></li>
<li><p><strong>gradient_acc_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>global_num_tokens_per_train_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>num_seen_train_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>global_num_seen_tokens</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>num_target_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>num_target_tokens</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>gradient_clipper</strong> (<a class="reference internal" href="modalities.training.gradient_clipping.html#modalities.training.gradient_clipping.gradient_clipper.GradientClipperIF" title="modalities.training.gradient_clipping.gradient_clipper.GradientClipperIF"><em>GradientClipperIF</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.trainer.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_loader</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss_fun</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">training_log_interval_in_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluation_callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpointing_callback</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/trainer.html#Trainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.trainer.Trainer.train" title="Link to this definition"></a></dt>
<dd><p>Trains the model.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>model (nn.Module): The model to be trained.
train_loader (LLMDataLoader): The data loader containing the training data.
optimizer (Optimizer): The optimizer used for gradient updates.
scheduler (LRScheduler): The learning rate scheduler.
loss_fun (Loss): The loss function used for training.
training_log_interval_in_steps (int): The interval at which training progress is logged.
evaluation_callback (Callable[[TrainingProgress], None]): A callback function for evaluation.
checkpointing_callback (Callable[[TrainingProgress], None]): A callback function for checkpointing.</p>
</dd>
<dt>Returns:</dt><dd><p>None</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.7)"><em>Module</em></a>)</p></li>
<li><p><strong>train_loader</strong> (<a class="reference internal" href="modalities.dataloader.html#modalities.dataloader.dataloader.LLMDataLoader" title="modalities.dataloader.dataloader.LLMDataLoader"><em>LLMDataLoader</em></a>)</p></li>
<li><p><strong>optimizer</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.7)"><em>Optimizer</em></a>)</p></li>
<li><p><strong>scheduler</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.LRScheduler.html#torch.optim.lr_scheduler.LRScheduler" title="(in PyTorch v2.7)"><em>LRScheduler</em></a>)</p></li>
<li><p><strong>loss_fun</strong> (<a class="reference internal" href="#modalities.loss_functions.Loss" title="modalities.loss_functions.Loss"><em>Loss</em></a>)</p></li>
<li><p><strong>training_log_interval_in_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>evaluation_callback</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress" title="modalities.training.training_progress.TrainingProgress"><em>TrainingProgress</em></a><em>]</em><em>, </em><em>None</em><em>]</em>)</p></li>
<li><p><strong>checkpointing_callback</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference internal" href="modalities.training.html#modalities.training.training_progress.TrainingProgress" title="modalities.training.training_progress.TrainingProgress"><em>TrainingProgress</em></a><em>]</em><em>, </em><em>None</em><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-modalities.util">
<span id="modalities-util-module"></span><h2>modalities.util module<a class="headerlink" href="#module-modalities.util" title="Link to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="modalities.util.Aggregator">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">Aggregator</span></span><a class="reference internal" href="../_modules/modalities/util.html#Aggregator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.Aggregator" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Generic" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Generic</span></code></a>[<code class="xref py py-obj docutils literal notranslate"><span class="pre">T</span></code>]</p>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.util.Aggregator.add_value">
<span class="sig-name descname"><span class="pre">add_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#Aggregator.add_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.Aggregator.add_value" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>T</em>)</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.util.Aggregator.get_all_reduced_value">
<span class="sig-name descname"><span class="pre">get_all_reduced_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduce_operation=&lt;RedOpType.SUM:</span> <span class="pre">0&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">postprocessing_fun=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#Aggregator.get_all_reduced_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.Aggregator.get_all_reduced_value" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>key</strong> (<em>T</em>)</p></li>
<li><p><strong>reduce_operation</strong> (<em>RedOpType</em>)</p></li>
<li><p><strong>postprocessing_fun</strong> (<em>None</em><em> | </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.13)"><em>Callable</em></a><em>[</em><em>[</em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.7)"><em>Tensor</em></a><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.util.Aggregator.remove_key">
<span class="sig-name descname"><span class="pre">remove_key</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#Aggregator.remove_key"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.Aggregator.remove_key" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<em>T</em>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.util.Aggregator.remove_keys">
<span class="sig-name descname"><span class="pre">remove_keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#Aggregator.remove_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.Aggregator.remove_keys" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.util.TimeRecorder">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">TimeRecorder</span></span><a class="reference internal" href="../_modules/modalities/util.html#TimeRecorder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.TimeRecorder" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class with context manager to record execution time</p>
<dl class="py method">
<dt class="sig sig-object py" id="modalities.util.TimeRecorder.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#TimeRecorder.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.TimeRecorder.reset" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.util.TimeRecorder.start">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#TimeRecorder.start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.TimeRecorder.start" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="modalities.util.TimeRecorder.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#TimeRecorder.stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.TimeRecorder.stop" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="modalities.util.TimeRecorderStates">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">TimeRecorderStates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#TimeRecorderStates"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.TimeRecorderStates" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.util.TimeRecorderStates.RUNNING">
<span class="sig-name descname"><span class="pre">RUNNING</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'RUNNING'</span></em><a class="headerlink" href="#modalities.util.TimeRecorderStates.RUNNING" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="modalities.util.TimeRecorderStates.STOPPED">
<span class="sig-name descname"><span class="pre">STOPPED</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'STOPPED'</span></em><a class="headerlink" href="#modalities.util.TimeRecorderStates.STOPPED" title="Link to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.format_metrics_to_gb">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">format_metrics_to_gb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">item</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#format_metrics_to_gb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.format_metrics_to_gb" title="Link to this definition"></a></dt>
<dd><p>quick function to format numbers to gigabyte and round to 4 digit precision</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_callback_interval_in_batches_per_rank">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_callback_interval_in_batches_per_rank</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">local_callback_interval_in_samples</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">local_train_micro_batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_acc_steps</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_callback_interval_in_batches_per_rank"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_callback_interval_in_batches_per_rank" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>local_callback_interval_in_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>local_train_micro_batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>gradient_acc_steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_experiment_id_of_run">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_experiment_id_of_run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_file_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hash_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_experiment_id_of_run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_experiment_id_of_run" title="Link to this definition"></a></dt>
<dd><p>create experiment ID including the date and time for file save uniqueness
example: 2022-05-07__14-31-22_fdh1xaj2’</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>config_file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.13)"><em>Path</em></a>)</p></li>
<li><p><strong>hash_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_local_number_of_trainable_parameters">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_local_number_of_trainable_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_local_number_of_trainable_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_local_number_of_trainable_parameters" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.7)"><em>Module</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_module_class_from_name">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_module_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_module_class_from_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_module_class_from_name" title="Link to this definition"></a></dt>
<dd><p>From Accelerate source code
(<a class="reference external" href="https://github.com/huggingface/accelerate/blob/1f7a79b428749f45187ec69485f2c966fe21926e/src/accelerate/utils/dataclasses.py#L1902">https://github.com/huggingface/accelerate/blob/1f7a79b428749f45187ec69485f2c966fe21926e/src/accelerate/utils/dataclasses.py#L1902</a>)
Gets a class from a module by its name.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Type</span></code></a>[<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.7)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a>]]</span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>module</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.7)"><em>Module</em></a>)</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Args:</dt><dd><p>module (<cite>torch.nn.Module</cite>): The module to get the class from.
name (<cite>str</cite>): The name of the class.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.get_total_number_of_trainable_parameters">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">get_total_number_of_trainable_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#get_total_number_of_trainable_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.get_total_number_of_trainable_parameters" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Union" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Union</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>]</span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>model</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/fsdp.html#torch.distributed.fsdp.FullyShardedDataParallel" title="(in PyTorch v2.7)"><em>FullyShardedDataParallel</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.parse_enum_by_name">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">parse_enum_by_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enum_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#parse_enum_by_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.parse_enum_by_name" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Enum</span></code></a></span></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p></li>
<li><p><strong>enum_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Type" title="(in Python v3.13)"><em>Type</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/enum.html#enum.Enum" title="(in Python v3.13)"><em>Enum</em></a><em>]</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.print_rank_0">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">print_rank_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#print_rank_0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.print_rank_0" title="Link to this definition"></a></dt>
<dd><p>If torch.distributed is initialized, print only on rank 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>message</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="modalities.util.warn_rank_0">
<span class="sig-prename descclassname"><span class="pre">modalities.util.</span></span><span class="sig-name descname"><span class="pre">warn_rank_0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">message</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/modalities/util.html#warn_rank_0"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#modalities.util.warn_rank_0" title="Link to this definition"></a></dt>
<dd><p>If torch.distributed is initialized, print only on rank 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>message</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-modalities">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-modalities" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="modalities" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="modalities.checkpointing.html" class="btn btn-neutral float-right" title="modalities.checkpointing package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Fraunhofer.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>